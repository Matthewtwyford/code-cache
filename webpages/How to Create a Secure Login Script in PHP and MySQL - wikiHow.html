<!DOCTYPE html>
<html class="client-js" xmlns:fb="https://www.facebook.com/2008/fbml" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" dir="ltr" lang="en"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#"><script async="" src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/cbgapi_003.js"></script><script src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/client.js" async="" type="text/javascript" id="LR1"></script><script async="" src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/cbgapi.js"></script><script async="" src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/cbgapi_002.js"></script><script src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/pinit_main.js" async="" type="text/javascript"></script><script async="" src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/tracker.js" type="text/javascript"></script><script gapi_processed="true" src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/clientplusone.js" async="" type="text/javascript"></script>
	<title>How to Create a Secure Login Script in PHP and MySQL - wikiHow</title>
	<script src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/ci.js" async="" type="text/javascript"></script><script src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/ga.js" async="" type="text/javascript"></script><script src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/gpt.js" type="text/javascript" async=""></script><script>
<!--
var WH = WH || {};
//-->
</script>

			<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta name="verify-v1" content="/Ur0RE4/QGQIq9F46KZyKIyL0ZnS96N5x1DwQJa7bR8=">
	<meta name="google-site-verification" content="Jb3uMWyKPQ3B9lzp5hZvJjITDKG8xI8mnEpWifGXUb0">
	<meta name="msvalidate.01" content="CFD80128CAD3E726220D4C2420D539BE">
	<meta name="y_key" content="1b3ab4fc6fba3ab3">
	<meta name="p:domain_verify" content="bb366527fa38aa5bc27356b728a2ec6f">
		<link rel="alternate" media="only screen and (max-width: 640px)" href="http://m.wikihow.com/Create-a-Secure-Login-Script-in-PHP-and-MySQL">
			<style type="text/css" media="all">/*<![CDATA[*/ @import "/extensions/min/g/whcss,slc,altc,tptc&r=162e1f&e=.css"; /*]]>*/</style>
		<style type="text/css" media="print">/*<![CDATA[*/ body{background-color:#FFF;font-size:1.2em}#header_outer{background:0 0;position:relative}#header{text-align:center;height:63px!important;width:242px!important;background:url(/skins/owl/images/logo_lightbg_242.jpg) no-repeat center center;margin-top:15px}#article_shell{margin:0 auto;float:none;padding-bottom:2em}.sticking{position:absolute!important;top:0!important}#actions,#article_rating,#article_tabs,#breadcrumb,#bubble_search,#cse-search-box,#end_options,#footer_outer,#header_space,#logo_link,#notification_count,#originators,#sidebar,#sliderbox,.edit,.editsection,.mwimg,.section.relatedwikihows,.section.video,.whvid_cont,.altadder_section{display:none!important} /*]]>*/</style>	
				<script>
			<!--
			var WH = WH || {};
			WH.lang = WH.lang || {};
			button_swap = button_unswap = function(){};
			WH.exitTimerStartTime = (new Date()).getTime();
			WH.mergeLang = function(A){for(i in A){v=A[i];if(typeof v==='string'){WH.lang[i]=v;}}};
			//-->
		</script>
		
		<meta name="generator" content="MediaWiki 1.23wmf15">
<meta name="robots" content="index,follow"><!--noneapply-->
<meta name="description" content="How to Create a Secure Login Script in PHP and MySQL. With more and more stories of cracking in the news, developers are looking for the best ways of securing their sites. If your site has a member system, it could be at risk from being...">
<meta name="keywords" content="WikiHow, Create a Secure Login Script in PHP and MySQL, wiki, how to articles, how to instructions, DIY, tips, howto, learn, how do I">
<link rel="alternate" type="application/x-wiki" title="Edit" href="http://www.wikihow.com/index.php?title=Create-a-Secure-Login-Script-in-PHP-and-MySQL&amp;action=edit">
<link rel="edit" title="Edit" href="http://www.wikihow.com/index.php?title=Create-a-Secure-Login-Script-in-PHP-and-MySQL&amp;action=edit">
<link rel="shortcut icon" href="http://www.wikihow.com/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="http://www.wikihow.com/opensearch_desc.php" title="wikiHow (en)">
<link rel="EditURI" type="application/rsd+xml" href="http://www.wikihow.com/api.php?action=rsd">
<link rel="alternate" type="application/atom+xml" title="wikiHow Atom feed" href="http://www.wikihow.com/index.php?title=Special:RecentChanges&amp;feed=atom">		
				<link rel="canonical" href="http://www.wikihow.com/Create-a-Secure-Login-Script-in-PHP-and-MySQL">
			<link href="https://plus.google.com/102818024478962731382" rel="publisher">
						<!-- not mobile -->
			<!--<![endif]-->
		<link rel="alternate" type="application/rss+xml" title="wikiHow: How-to of the Day" href="http://www.wikihow.com/feed.rss">
	<link rel="apple-touch-icon" href="http://pad3.whstatic.com/skins/WikiHow/safari-large-icon.png">
			<style type="text/css">/*<![CDATA[*/
.source-sql {line-height: normal;}
.source-sql li, .source-sql pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for sql
 * CSS class: source-sql, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.sql.source-sql .de1, .sql.source-sql .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.sql.source-sql  {font-family:monospace;}
.sql.source-sql .imp {font-weight: bold; color: red;}
.sql.source-sql li, .sql.source-sql .li1 {font-weight: normal; vertical-align:top;}
.sql.source-sql .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.sql.source-sql .li2 {font-weight: bold; vertical-align:top;}
.sql.source-sql .kw1 {color: #993333; font-weight: bold;}
.sql.source-sql .co1 {color: #808080; font-style: italic;}
.sql.source-sql .coMULTI {color: #808080; font-style: italic;}
.sql.source-sql .es0 {color: #000099; font-weight: bold;}
.sql.source-sql .br0 {color: #66cc66;}
.sql.source-sql .sy0 {color: #66cc66;}
.sql.source-sql .st0 {color: #ff0000;}
.sql.source-sql .nu0 {color: #cc66cc;}
.sql.source-sql .ln-xtra, .sql.source-sql li.ln-xtra, .sql.source-sql div.ln-xtra {background-color: #ffc;}
.sql.source-sql span.xtra { display:block; }

/*]]>*/
</style><style type="text/css">/*<![CDATA[*/
.source-php {line-height: normal;}
.source-php li, .source-php pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for php
 * CSS class: source-php, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.php.source-php .de1, .php.source-php .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.php.source-php  {font-family:monospace;}
.php.source-php .imp {font-weight: bold; color: red;}
.php.source-php li, .php.source-php .li1 {font-weight: normal; vertical-align:top;}
.php.source-php .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.php.source-php .li2 {font-weight: bold; vertical-align:top;}
.php.source-php .kw1 {color: #b1b100;}
.php.source-php .kw2 {color: #000000; font-weight: bold;}
.php.source-php .kw3 {color: #990000;}
.php.source-php .kw4 {color: #009900; font-weight: bold;}
.php.source-php .co1 {color: #666666; font-style: italic;}
.php.source-php .co2 {color: #666666; font-style: italic;}
.php.source-php .co3 {color: #0000cc; font-style: italic;}
.php.source-php .co4 {color: #009933; font-style: italic;}
.php.source-php .coMULTI {color: #666666; font-style: italic;}
.php.source-php .es0 {color: #000099; font-weight: bold;}
.php.source-php .es1 {color: #000099; font-weight: bold;}
.php.source-php .es2 {color: #660099; font-weight: bold;}
.php.source-php .es3 {color: #660099; font-weight: bold;}
.php.source-php .es4 {color: #006699; font-weight: bold;}
.php.source-php .es5 {color: #006699; font-weight: bold; font-style: italic;}
.php.source-php .es6 {color: #009933; font-weight: bold;}
.php.source-php .es_h {color: #000099; font-weight: bold;}
.php.source-php .br0 {color: #009900;}
.php.source-php .sy0 {color: #339933;}
.php.source-php .sy1 {color: #000000; font-weight: bold;}
.php.source-php .st0 {color: #0000ff;}
.php.source-php .st_h {color: #0000ff;}
.php.source-php .nu0 {color: #cc66cc;}
.php.source-php .nu8 {color: #208080;}
.php.source-php .nu12 {color: #208080;}
.php.source-php .nu19 {color:#800080;}
.php.source-php .me1 {color: #004000;}
.php.source-php .me2 {color: #004000;}
.php.source-php .re0 {color: #000088;}
.php.source-php .ln-xtra, .php.source-php li.ln-xtra, .php.source-php div.ln-xtra {background-color: #ffc;}
.php.source-php span.xtra { display:block; }

/*]]>*/
</style><style type="text/css">/*<![CDATA[*/
.source-javascript {line-height: normal;}
.source-javascript li, .source-javascript pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for javascript
 * CSS class: source-javascript, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.javascript.source-javascript .de1, .javascript.source-javascript .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.javascript.source-javascript  {font-family:monospace;}
.javascript.source-javascript .imp {font-weight: bold; color: red;}
.javascript.source-javascript li, .javascript.source-javascript .li1 {font-weight: normal; vertical-align:top;}
.javascript.source-javascript .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.javascript.source-javascript .li2 {font-weight: bold; vertical-align:top;}
.javascript.source-javascript .kw1 {color: #000066; font-weight: bold;}
.javascript.source-javascript .kw2 {color: #003366; font-weight: bold;}
.javascript.source-javascript .kw3 {color: #000066;}
.javascript.source-javascript .kw5 {color: #FF0000;}
.javascript.source-javascript .co1 {color: #006600; font-style: italic;}
.javascript.source-javascript .co2 {color: #009966; font-style: italic;}
.javascript.source-javascript .coMULTI {color: #006600; font-style: italic;}
.javascript.source-javascript .es0 {color: #000099; font-weight: bold;}
.javascript.source-javascript .br0 {color: #009900;}
.javascript.source-javascript .sy0 {color: #339933;}
.javascript.source-javascript .st0 {color: #3366CC;}
.javascript.source-javascript .nu0 {color: #CC0000;}
.javascript.source-javascript .me1 {color: #660066;}
.javascript.source-javascript .ln-xtra, .javascript.source-javascript li.ln-xtra, .javascript.source-javascript div.ln-xtra {background-color: #ffc;}
.javascript.source-javascript span.xtra { display:block; }

/*]]>*/
</style><meta property="og:title" content="How to Create a Secure Login Script in PHP and MySQL">
<meta property="og:type" content="article">
<meta property="og:url" content="http://www.wikihow.com/Create-a-Secure-Login-Script-in-PHP-and-MySQL">
<meta property="og:site_name" content="wikiHow">
<meta property="og:description" content="With more and more stories of cracking in the news, developers are looking for the best ways of securing their sites. If your site has a member system, it could be at risk from being cracked and your users' data could be compromised. This...">
<meta property="og:image" content="http://www.wikihow.com/images/d/dc/Category_computers.jpg">
			
	
					<link rel="alternate" hreflang="pt" href="http://pt.wikihow.com/Criar-um-Script-de-Login-Seguro-em-PHP-e-MySQL">
					<link rel="alternate" hreflang="es" href="http://es.wikihow.com/crear-un-script-de-inicio-de-sesi%C3%B3n-segura-en-php-y-MySQL">
					<link rel="alternate" hreflang="it" href="http://it.wikihow.com/Creare-uno-Script-Sicuro-per-il-Login-Usando-PHP-e-MySQL">
					<link rel="alternate" hreflang="de" href="http://de.wikihow.com/Ein-sicheres-Login-Skript-mit-PHP-und-MySQL-erstellen">
					<link rel="alternate" hreflang="fr" href="http://fr.wikihow.com/cr%C3%A9er-un-script-de-connexion-s%C3%A9curis%C3%A9e-avec-PHP-et-MySQL">
					<link rel="alternate" hreflang="ru" href="http://ru.wikihow.com/%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D1%82%D1%8C-%D0%B1%D0%B5%D0%B7%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D1%8B%D0%B9-%D0%BB%D0%BE%D0%B3%D0%B8%D0%BD-%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-%D0%B2-PHP-%D0%B8-MySQL">
				<script src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/pubads_impl_37.js" type="text/javascript" async=""></script><script src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/osd.js" type="text/javascript"></script><script src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/load.js" async=""></script><style>
.mw-collapsible-toggle{float:right;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none} caption .mw-collapsible-toggle{float:none} li .mw-collapsible-toggle{float:none} .mw-collapsible-toggle-li{list-style:none}
/* cache key: wikidb_112:resourceloader:filter:minify-css:7:6c1d24e90626cec584f0869483f983e7 */
.suggestions{overflow:hidden;position:absolute;top:0;left:0;width:0;border:none;z-index:1099;padding:0;margin:-1px -1px 0 0} html > body .suggestions{margin:-1px 0 0 0}.suggestions-special{position:relative;background-color:white;cursor:pointer;border:solid 1px #aaaaaa;padding:0;margin:0;margin-top:-2px;display:none;padding:0.25em 0.25em;line-height:1.25em}.suggestions-results{background-color:white;cursor:pointer;border:solid 1px #aaaaaa;padding:0;margin:0}.suggestions-result{color:black;margin:0;line-height:1.5em;padding:0.01em 0.25em;text-align:left}.suggestions-result-current{background-color:#4C59A6;color:white}.suggestions-special .special-label{color:gray;text-align:left}.suggestions-special .special-query{color:black;font-style:italic;text-align:left}.suggestions-special .special-hover{background-color:silver}.suggestions-result-current .special-label,.suggestions-result-current .special-query{color:white}.autoellipsis-matched,.highlight{font-weight:bold}
/* cache key: wikidb_112:resourceloader:filter:minify-css:7:9780324491b653a3780e2d029bdc140c */
.postedit-container{margin:0 auto;position:fixed;top:0;height:0;left:50%;z-index:1000;font-size:13px}.postedit-container:hover{cursor:pointer}.postedit{position:relative;top:0.6em;left:-50%;padding:.6em 3.6em .6em 1.1em;line-height:1.5625em;color:#626465;background-color:#f4f4f4;border:1px solid #dcd9d9;text-shadow:0 0.0625em 0 rgba(255,255,255,0.5);border-radius:5px;-webkit-box-shadow:0 2px 5px 0 #ccc;box-shadow:0 2px 5px 0 #ccc;-webkit-transition:all 0.25s ease-in-out;-moz-transition:all 0.25s ease-in-out;-ms-transition:all 0.25s ease-in-out;-o-transition:all 0.25s ease-in-out;transition:all 0.25s ease-in-out}.skin-monobook .postedit{top:6em !important}.postedit-faded{opacity:0}.postedit-icon{padding-left:41px;  line-height:25px;background-repeat:no-repeat;background-position:8px 50%}.postedit-icon-checkmark{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABblBMVEUAAAD///////9PfTf///80aRdTgjn///9Feij///////////9Rfzf///////////9PfjZRgDh1o1xOfTb///////+bwYqLtnj///////9PfTa82K////9WhT6YxIL///9QgDdTgzr////////j7uDl7eLq8efi693k7OH///////9UhjuBr2rp9uRUhjr///9YljVKgir///9WiTlYjT3////9/v57vFlbkT5PjC9dlD/5/fhuq09stUTs9uhxuElctCpfnT1huDFloEZloUZmpENmvDZpvDxpvTxqvjxrvT5rvT9rwTxsqktswD5uwkBvuUdxw0NztFBztU9ztVBzwkp0tlJ1xkd2t1R3uVR4w1F4xk54x014yE15uVZ5v1R5xVB6v1R7yFJ8wVh9xVl9yFR9yVd9ylN+xVh+yFd/x1l/yFeAylmEx1+Ny2uY0Hqe04Wj1Ymv3Ze33qLD47TJ5L3O6cPU7Mrq9eb2+/Q4j37OAAAAQHRSTlMAAQIEBAUFBQwPFB4fJCUoKiosQEhJS01RUlZZXmdydXaChYuSlJSWmJmoq6uur8LExcvM19fg5ejt8fX2+Pr7SljgewAAAKpJREFUGBkFwQNCAwAAAMDLtl3LtrG4rWXbtvX77gAgZ6grFwC0bhwNVgKgdPZx8b0dgLi+s7Wn0VoAqpfOI9+BNADZI7fLrz2pSEwGHZuH+78lSK8ZLkLezF3ooyUG3VPXq2USei9WngeyoG195yBYWDF3E/2pAhl1e9Gr8bGT+bfOFCC2fnvh4X7rcqIAQNNu+HT6sxkAjceTL/2ZAIhv+PorBwBJxfkA//dFHSCBy/UTAAAAAElFTkSuQmCC);background-image:url(/resources/mediawiki.action/images/green-checkmark.png?2014-03-14T21:38:20Z)!ie;background-position:left}.postedit-close{position:absolute;padding:0 .8em;right:0;top:0;font-size:1.25em;font-weight:bold;line-height:2.3em;color:black;text-shadow:0 0.0625em 0 white;text-decoration:none;opacity:0.2;filter:alpha(opacity=20)}.postedit-close:hover{color:black;text-decoration:none;opacity:0.4;filter:alpha(opacity=40)}
/* cache key: wikidb_112:resourceloader:filter:minify-css:7:14006b97b876a2cd22ec3cda6268d5db */
#drafts-list-table{margin-left:-5px;margin-right:-5px}#drafts-list-table td,#drafts-list-table th{text-align:left}.rtl #drafts-list-table td,.rtl #drafts-list-table th{text-align:right}
/* cache key: wikidb_112:resourceloader:filter:minify-css:7:7ab7ccda082e828c51a69f1548414cde */</style><style>
.suggestions a.mw-searchSuggest-link,.suggestions a.mw-searchSuggest-link:hover,.suggestions a.mw-searchSuggest-link:active,.suggestions a.mw-searchSuggest-link:focus{text-decoration:none;color:black}.suggestions-result-current a.mw-searchSuggest-link,.suggestions-result-current a.mw-searchSuggest-link:hover,.suggestions-result-current a.mw-searchSuggest-link:active,.suggestions-result-current a.mw-searchSuggest-link:focus{color:white}
/* cache key: wikidb_112:resourceloader:filter:minify-css:7:52b1797f70c7e4094dfa4191101944e8 */</style><meta name="ResourceLoaderDynamicStyles"><style type="text/css">a.PIN_1398286719774_pin_it_button_20 {  background-repeat: none!important; background-size: 40px 60px!important; height: 20px!important; margin: 0!important; padding: 0!important; vertical-align: baseline!important; text-decoration: none!important; width: 40px!important; background-position: 0 -20px }
a.PIN_1398286719774_pin_it_button_20:hover { background-position: 0 0px }
a.PIN_1398286719774_pin_it_button_20:active, a.PIN_1398286719774_pin_it_button_20.PIN_1398286719774_hazClick { background-position: 0 -40px }
a.PIN_1398286719774_pin_it_button_inline_20 { position: relative!important; display: inline-block!important; }
a.PIN_1398286719774_pin_it_button_floating_20 { position: absolute!important; }
a.PIN_1398286719774_pin_it_button_en_20_red { background-image: url(http://passets.pinterest.com/images/pidgets/pinit_bg_en_rect_red_20_2.png)!important; }
a.PIN_1398286719774_pin_it_button_en_20_white { background-image: url(http://passets.pinterest.com/images/pidgets/pinit_bg_en_rect_white_20_2.png)!important; }
a.PIN_1398286719774_pin_it_button_en_20_gray { background-image: url(http://passets.pinterest.com/images/pidgets/pinit_bg_en_rect_gray_20_2.png)!important; }
a.PIN_1398286719774_pin_it_button_ja_20_red { background-image: url(http://passets.pinterest.com/images/pidgets/pinit_bg_ja_rect_red_20_2.png)!important; }
a.PIN_1398286719774_pin_it_button_ja_20_white { background-image: url(http://passets.pinterest.com/images/pidgets/pinit_bg_ja_rect_white_20_2.png)!important; }
a.PIN_1398286719774_pin_it_button_ja_20_gray { background-image: url(http://passets.pinterest.com/images/pidgets/pinit_bg_ja_rect_gray_20_2.png)!important; }
a.PIN_1398286719774_pin_it_above_20 span.PIN_1398286719774_pin_it_button_count { background: transparent url(http://passets.pinterest.com/images/pidgets/count_north_white_rect_20_2.png) 0 0 no-repeat!important; background-size: 40px 29px!important; position: absolute!important; bottom: 21px!important; left: 0px!important; height: 29px!important; width: 40px!important; font: 12px Arial, Helvetica, sans-serif!important; line-height: 24px!important; text-indent: 0!important;}
a.PIN_1398286719774_pin_it_button_20 span.PIN_1398286719774_pin_it_button_count { position: absolute!important; color: #777!important; text-align: center!important; text-indent: 0!important; }
a.PIN_1398286719774_pin_it_beside_20 span.PIN_1398286719774_pin_it_button_count, a.PIN_1398286719774_pin_it_beside_20 span.PIN_1398286719774_pin_it_button_count i { background-color: transparent!important; background-repeat: no-repeat!important; background-image: url(http://passets.pinterest.com/images/pidgets/count_east_white_rect_20_2.png)!important; }
a.PIN_1398286719774_pin_it_beside_20 span.PIN_1398286719774_pin_it_button_count { padding: 0 3px 0 10px!important; background-size: 45px 20px!important; background-position: 0 0!important; position: absolute!important; top: 0!important; left: 41px!important; height: 20px!important; font: 10px Arial, Helvetica, sans-serif!important; line-height: 20px!important; }
a.PIN_1398286719774_pin_it_beside_20 span.PIN_1398286719774_pin_it_button_count i { background-position: 100% 0!important; position: absolute!important; top: 0!important; right: -2px!important; height: 20px!important; width: 2px!important; }
a.PIN_1398286719774_pin_it_button_20.PIN_1398286719774_pin_it_above { margin-top: 20px!important; }
a.PIN_1398286719774_pin_it_button_28 { background-repeat: none!important; background-size: 56px 84px!important; height: 28px!important; margin: 0!important; padding: 0!important; vertical-align: baseline!important; text-decoration: none!important; width: 56px!important; background-position: 0 -28px }
a.PIN_1398286719774_pin_it_button_28:hover { background-position: 0 0px }
a.PIN_1398286719774_pin_it_button_28:active, a.PIN_1398286719774_pin_it_button_28.PIN_1398286719774_hazClick { background-position: 0 -56px }
a.PIN_1398286719774_pin_it_button_inline_28 { position: relative!important; display: inline-block!important; }
a.PIN_1398286719774_pin_it_button_floating_28 { position: absolute!important; }
a.PIN_1398286719774_pin_it_button_en_28_red { background-image: url(http://passets.pinterest.com/images/pidgets/pinit_bg_en_rect_red_28_2.png)!important; }
a.PIN_1398286719774_pin_it_button_en_28_white { background-image: url(http://passets.pinterest.com/images/pidgets/pinit_bg_en_rect_white_28_2.png)!important; }
a.PIN_1398286719774_pin_it_button_en_28_gray { background-image: url(http://passets.pinterest.com/images/pidgets/pinit_bg_en_rect_gray_28_2.png)!important; }
a.PIN_1398286719774_pin_it_button_ja_28_red { background-image: url(http://passets.pinterest.com/images/pidgets/pinit_bg_ja_rect_red_28_2.png)!important; }
a.PIN_1398286719774_pin_it_button_ja_28_white { background-image: url(http://passets.pinterest.com/images/pidgets/pinit_bg_ja_rect_white_28_2.png)!important; }
a.PIN_1398286719774_pin_it_button_ja_28_gray { background-image: url(http://passets.pinterest.com/images/pidgets/pinit_bg_ja_rect_gray_28_2.png)!important; }
a.PIN_1398286719774_pin_it_button_en_16_red_round, a.PIN_1398286719774_pin_it_button_en_32_red_round { background-repeat: none!important; margin: 0!important; padding: 0!important; vertical-align: baseline!important; text-decoration: none!important; }
a.PIN_1398286719774_pin_it_button_en_16_red_round { height: 16px!important; width: 16px!important; background-size: 16px 16px!important; background-image: url(http://passets.pinterest.com/images/pidgets/pinit_bg_en_round_red_16_2.png)!important;}
a.PIN_1398286719774_pin_it_button_en_32_red_round { height: 32px!important; width: 32px!important; background-size: 32px 32px!important; background-image: url(http://passets.pinterest.com/images/pidgets/pinit_bg_en_round_red_32_2.png)!important;}
a.PIN_1398286719774_pin_it_button_inline_en_16_red_round, a.PIN_1398286719774_pin_it_button_inline_en_32_red_round { position: relative!important; display: inline-block!important; }
a.PIN_1398286719774_pin_it_button_floating_en_16_red_round, a.PIN_1398286719774_pin_it_button_floating_en_32_red_round  { position: absolute!important; }
a.PIN_1398286719774_pin_it_button_28 span.PIN_1398286719774_pin_it_button_count { position: absolute!important; color: #777!important; text-align: center!important; text-indent: 0!important; }
a.PIN_1398286719774_pin_it_above_28 span.PIN_1398286719774_pin_it_button_count { background: transparent url(http://passets.pinterest.com/images/pidgets/count_north_white_rect_28_2.png) 0 0 no-repeat!important; background-size: 56px 37px!important; position: absolute!important; bottom: 29px!important; left: 0px!important; height: 37px!important; width: 56px!important; font: 15px Arial, Helvetica, sans-serif!important; line-height: 28px!important; text-indent: 0!important;}
a.PIN_1398286719774_pin_it_beside_28 span.PIN_1398286719774_pin_it_button_count, a.PIN_1398286719774_pin_it_beside_28 span.PIN_1398286719774_pin_it_button_count i { background-color: transparent!important; background-repeat: no-repeat!important; background-image: url(http://passets.pinterest.com/images/pidgets/count_east_white_rect_28_2.png)!important; }
a.PIN_1398286719774_pin_it_beside_28 span.PIN_1398286719774_pin_it_button_count { padding: 0 3px 0 10px!important; background-size: 63px 28px!important; background-position: 0 0!important; position: absolute!important; top: 0!important; left: 57px!important; height: 28px!important; font: 12px Arial, Helvetica, sans-serif!important; line-height: 28px!important; }
a.PIN_1398286719774_pin_it_beside_28 span.PIN_1398286719774_pin_it_button_count i { background-position: 100% 0!important; position: absolute!important; top: 0!important; right: -2px!important; height: 28px!important; width: 2px!important; }
a.PIN_1398286719774_pin_it_button_28.PIN_1398286719774_pin_it_above { margin-top: 28px!important; }
a.PIN_1398286719774_follow_me_button, a.PIN_1398286719774_follow_me_button i { background-size: 200px 60px!important; background: transparent url(http://passets.pinterest.com/images/pidgets/bfs2.png) 0 0 no-repeat }
a.PIN_1398286719774_follow_me_button { color: #444!important; display: inline-block!important; font: bold normal normal 11px/20px "Helvetica Neue",helvetica,arial,san-serif!important; height: 20px!important; margin: 0!important; padding: 0!important; position: relative!important; text-decoration: none!important; text-indent: 19px!important; vertical-align: baseline!important;}
a.PIN_1398286719774_follow_me_button:hover { background-position: 0 -20px}
a.PIN_1398286719774_follow_me_button:active  { background-position: 0 -40px}
a.PIN_1398286719774_follow_me_button b { position: absolute!important; top: 3px!important; left: 3px!important; height: 14px!important; width: 14px!important; background-size: 14px 14px!important; background-image: url(http://passets.pinterest.com/images/pidgets/log2.png)!important; }
a.PIN_1398286719774_follow_me_button i { position: absolute!important; top: 0!important; right: -4px!important; height: 20px!important; width: 4px!important; background-position: 100% 0px!important; }
a.PIN_1398286719774_follow_me_button:hover i { background-position: 100% -20px!important;  }
a.PIN_1398286719774_follow_me_button:active i { background-position: 100% -40px!important; }
a.PIN_1398286719774_follow_me_button_tall, a.PIN_1398286719774_follow_me_button_tall i { background-size: 400px 84px!important; background: transparent url(http://passets.pinterest.com/images/pidgets/bft2.png) 0 0 no-repeat }
a.PIN_1398286719774_follow_me_button_tall { color: #444!important; display: inline-block!important; font: bold normal normal 13px/28px "Helvetica Neue",helvetica,arial,san-serif!important; height: 28px!important; margin: 0!important; padding: 0!important; position: relative!important; text-decoration: none!important; text-indent: 33px!important; vertical-align: baseline!important;}
a.PIN_1398286719774_follow_me_button_tall:hover { background-position: 0 -28px}
a.PIN_1398286719774_follow_me_button_tall:active  { background-position: 0 -56px}
a.PIN_1398286719774_follow_me_button_tall b { position: absolute!important; top: 5px!important; left: 10px!important; height: 18px!important; width: 18px!important; background-size: 18px 18px!important; background-image: url(http://passets.pinterest.com/images/pidgets/smt2.png)!important; }
a.PIN_1398286719774_follow_me_button_tall i { position: absolute!important; top: 0!important; right: -10px!important; height: 28px!important; width: 10px!important; background-position: 100% 0px!important; }
a.PIN_1398286719774_follow_me_button_tall:hover i { background-position: 100% -28px!important;  }
a.PIN_1398286719774_follow_me_button_tall:active i { background-position: 100% -56px!important; }
span.PIN_1398286719774_embed_pin { display: inline-block!important; text-align: center!important; width: 237px!important; overflow: hidden!important; vertical-align: top!important; }
span.PIN_1398286719774_embed_pin.PIN_1398286719774_fancy { background: #fff!important; box-shadow: 0 0 3px #aaa!important; border-radius: 3px!important; }
span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_link { display: block!important;  margin: 0 auto!important; padding: 0!important; position: relative!important;  line-height: 0}
span.PIN_1398286719774_embed_pin img { border: 0!important; margin: 0!important; padding: 0!important;}
span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_link i.PIN_1398286719774_repin { left: 10px!important; top: 10px!important; position: absolute!important; height: 33px!important; width: 64px!important; background-size: 64px 99px!important; background: transparent url(http://passets.pinterest.com/images/pidgets/repin2.png) }
span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_link i.PIN_1398286719774_repin_ja { left: 10px!important; top: 10px!important; position: absolute!important; height: 33px!important; width: 64px!important; background-size: 64px 99px!important; background: transparent url(http://passets.pinterest.com/images/pidgets/ja_repin2.png) }
span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_link i.PIN_1398286719774_repin:hover { background-position: 0 -33px!important; }
span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_link i.PIN_1398286719774_repin.PIN_1398286719774_hazClick { background-position: 0 -66px!important; }
span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_link i.PIN_1398286719774_getThis { display: none }
span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_link:hover i.PIN_1398286719774_getThis, span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_link:hover i.PIN_1398286719774_getThis i { background: transparent url(http://passets.pinterest.com/images/pidgets/bfs1.png) }
span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_link:hover i.PIN_1398286719774_getThis { color: #555!important; display: inline-block!important; font: normal normal normal 11px/20px "Helvetica Neue",helvetica,arial,san-serif!important; height: 20px!important; margin: 0!important; padding: 0 1px 0 5px!important; position: absolute!important; bottom: 10px!important; right: 10px!important; text-decoration: none!important;  }
span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_link:hover i.PIN_1398286719774_getThis:hover { background-position: 0 -20px }
span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_link:hover i.PIN_1398286719774_getThis i { position: absolute!important; top: 0!important; right: -4px!important; height: 20px!important; width: 5px!important; background-position: 100% 0px }
span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_link:hover i.PIN_1398286719774_getThis:hover i { background-position: 100% -20px }
span.PIN_1398286719774_embed_pin span.PIN_1398286719774_embed_pin_desc { color: #333!important; white-space: normal!important; border-bottom: 1px solid #eee!important; display: block!important; font-family: "Helvetica Neue", arial, sans-serif!important; font-size: 12px!important; line-height: 17px!important; padding: 10px!important; text-align: left!important; }
span.PIN_1398286719774_embed_pin span.PIN_1398286719774_embed_pin_attrib, span.PIN_1398286719774_embed_pin span.PIN_1398286719774_embed_pin_text_container { color: #a7a7a7!important; font-family: "Helvetica", sans-serif!important; font-size: 10px!important; line-height: 18px!important; font-weight: bold!important; display: block!important;}
span.PIN_1398286719774_embed_pin span.PIN_1398286719774_embed_pin_attrib img.PIN_1398286719774_embed_pin_attrib_icon { height: 16px!important; width: 16px!important; vertical-align: middle!important; margin-right: 5px!important; float: left!important;}
span.PIN_1398286719774_embed_pin span.PIN_1398286719774_embed_pin_attrib a { color: #a7a7a7!important; text-decoration: none!important;}
span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_text, span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_text span.PIN_1398286719774_embed_pin_text_container { position: relative!important; text-decoration: none!important; display: block!important; font-weight: bold!important; color: #b7b7b7!important; font-family: "Helvetica Neue", arial, sans-serif!important; font-size: 11px!important; line-height: 14px!important; height: 39px!important; text-align: left!important; }
span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_text { padding: 5px 0 0 7px!important; }
span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_text:hover { background: #eee!important;}
span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_text img.PIN_1398286719774_embed_pin_text_avatar { border-radius: 2px!important; overflow: hidden!important; height: 30px!important; width: 30px!important; vertical-align: middle!important; margin-right: 5px!important; float: left!important;}
span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_text span.PIN_1398286719774_embed_pin_text_container em.PIN_1398286719774_embed_pin_text_container_em { font-family: inherit!important; display: block!important; color: #717171!important; font-style: normal!important; width: 180px!important; text-overflow: ellipsis!important; overflow: hidden!important; white-space: nowrap!important; }
span.PIN_1398286719774_embed_pin a.PIN_1398286719774_embed_pin_text b.PIN_1398286719774_embed_pin_link_shield { position: absolute!important; top: 0!important; left: 0!important; height: 100%!important; width: 100%!important; }
span.PIN_1398286719774_embed_grid { display: inline-block!important; margin: 0!important; padding:10px 0!important; position: relative!important; text-align: center}
span.PIN_1398286719774_embed_grid.PIN_1398286719774_fancy { background: #fff!important; box-shadow: 0 0 3px #aaa!important; border-radius: 3px!important; }
span.PIN_1398286719774_embed_grid span.PIN_1398286719774_embed_grid_hd { display: block!important; margin: 0 10px!important; padding: 0!important; height: 45px!important; position: relative!important; background: #fff}
span.PIN_1398286719774_embed_grid span.PIN_1398286719774_embed_grid_hd a.PIN_1398286719774_avatar { position: absolute!important; top: 0!important; left: 0!important; height: 36px!important; width: 36px!important; }
span.PIN_1398286719774_embed_grid span.PIN_1398286719774_embed_grid_hd a.PIN_1398286719774_avatar::before { position: absolute!important; content:""!important; z-index: 2!important; top: 0!important; left: 0!important; right: 0!important; bottom: 0!important; box-shadow: inset 0 0 2px #888!important;  border-radius: 3px!important; }
span.PIN_1398286719774_embed_grid span.PIN_1398286719774_embed_grid_hd a.PIN_1398286719774_avatar img { position: relative!important; height: 36px!important; width: 36px!important; margin: 0!important; padding: 0!important; border-radius: 3px!important; border: none!important;}
span.PIN_1398286719774_embed_grid span.PIN_1398286719774_embed_grid_hd a { text-decoration: none!important; background: transparent!important; cursor: pointer!important; white-space: nowrap!important; position: absolute!important; left: 44px!important; text-align: left!important; overflow: hidden!important; text-overflow: ellipsis!important; }
span.PIN_1398286719774_embed_grid span.PIN_1398286719774_embed_grid_hd a:hover { text-decoration: none!important; background: #fff!important; }
span.PIN_1398286719774_embed_grid span.PIN_1398286719774_embed_grid_hd a:active { text-decoration: none!important; background: #fff!important; }
span.PIN_1398286719774_embed_grid span.PIN_1398286719774_embed_grid_hd a.PIN_1398286719774_embed_grid_first { top: 2px!important; font-family: helvetica, sans-serif!important; font-weight: bold!important; color:#333!important; font-size: 14px!important; line-height: 16px!important; }
span.PIN_1398286719774_embed_grid span.PIN_1398286719774_embed_grid_hd a.PIN_1398286719774_embed_grid_second { bottom: 11px!important; font-family: helvetica, sans-serif!important; color:#8e8e8e!important; font-size: 12px!important; line-height: 14px!important; }
span.PIN_1398286719774_embed_grid span.PIN_1398286719774_embed_grid_hd a.PIN_1398286719774_embed_grid_mid { top: 12px!important; font-family: helvetica, sans-serif!important; font-weight: bold!important; color:#333!important; font-size: 14px!important; line-height: 16px!important; }
span.PIN_1398286719774_embed_grid span.PIN_1398286719774_embed_grid_bd { display:block!important; margin: 0 10px!important; border-radius: 2px!important; position: relative!important; overflow: hidden }
span.PIN_1398286719774_embed_grid span.PIN_1398286719774_embed_grid_scrolling_okay { overflow: auto!important; }
span.PIN_1398286719774_embed_grid span.PIN_1398286719774_embed_grid_bd span.PIN_1398286719774_embed_grid_ct { display:block!important; position: relative!important; overflow: hidden!important; }
span.PIN_1398286719774_embed_grid span.PIN_1398286719774_embed_grid_bd a.PIN_1398286719774_embed_grid_th { cursor: pointer!important; display: inline-block!important; position: absolute!important; overflow: hidden!important; }
span.PIN_1398286719774_embed_grid span.PIN_1398286719774_embed_grid_bd a.PIN_1398286719774_embed_grid_th::before { position: absolute!important; content:""!important; z-index: 2!important; top: 0!important; left: 0!important; right: 0!important; bottom: 0!important; box-shadow: inset 0 0 2px #888!important; }
span.PIN_1398286719774_embed_grid span.PIN_1398286719774_embed_grid_bd a.PIN_1398286719774_embed_grid_th img.PIN_1398286719774_embed_grid_img { border: none!important; position: absolute!important; top: 50%!important; left: 0!important; }
a.PIN_1398286719774_embed_grid_ft { text-shadow: 0 1px #fff!important; display: block!important; text-align: center!important; border: 1px solid #ccc!important; margin: 10px 10px 0!important; height: 31px!important; line-height: 30px!important;border-radius: 2px!important; text-decoration: none!important; font-family: Helvetica!important; font-weight: bold!important; font-size: 13px!important; color: #746d6a!important; background: #f4f4f4 url(http://passets.pinterest.com/images/pidgets/board_button_link.png) 0 0 repeat-x}
a.PIN_1398286719774_embed_grid_ft:hover { text-decoration: none!important; background: #fefefe url(http://passets.pinterest.com/images/pidgets/board_button_hover.png) 0 0 repeat-x}
a.PIN_1398286719774_embed_grid_ft:active { text-decoration: none!important; background: #e4e4e4 url(http://passets.pinterest.com/images/pidgets/board_button_active.png) 0 0 repeat-x}
a.PIN_1398286719774_embed_grid_ft span.PIN_1398286719774_embed_grid_ft_logo { vertical-align: top!important; display: inline-block!important; margin-left: 2px!important; height: 30px!important; width: 66px!important; background: transparent url(http://passets.pinterest.com/images/pidgets/board_button_logo.png) 50% 48% no-repeat!important; }
.PIN_1398286719774_hidden { display:none!important; }</style><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif);cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif)}.fb_dialog_close_icon:active{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v2/yL/r/s816eWC-2sl.gif)}.fb_dialog_loader{background-color:#f2f2f2;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #3b5998;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{max-height:590px;min-height:590px;max-width:500px;min-width:500px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;left:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29447e;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f2f2f2;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(http://static.ak.fbcdn.net/rsrc.php/v2/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}
.fb_connect_bar_container div,.fb_connect_bar_container span,.fb_connect_bar_container a,.fb_connect_bar_container img,.fb_connect_bar_container strong{background:none;border-spacing:0;border:0;direction:ltr;font-style:normal;font-variant:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal;vertical-align:baseline}.fb_connect_bar_container{position:fixed;left:0 !important;right:0 !important;height:42px !important;padding:0 25px !important;margin:0 !important;vertical-align:middle !important;border-bottom:1px solid #333 !important;background:#3b5998 !important;z-index:99999999 !important;overflow:hidden !important}.fb_connect_bar_container_ie6{position:absolute;top:expression(document.compatMode=="CSS1Compat"? document.documentElement.scrollTop+"px":body.scrollTop+"px")}.fb_connect_bar{position:relative;margin:auto;height:100%;width:100%;padding:6px 0 0 0 !important;background:none;color:#fff !important;font-family:"lucida grande", tahoma, verdana, arial, sans-serif !important;font-size:13px !important;font-style:normal !important;font-variant:normal !important;font-weight:normal !important;letter-spacing:normal !important;line-height:1 !important;text-decoration:none !important;text-indent:0 !important;text-shadow:none !important;text-transform:none !important;white-space:normal !important;word-spacing:normal !important}.fb_connect_bar a:hover{color:#fff}.fb_connect_bar .fb_profile img{height:30px;width:30px;vertical-align:middle;margin:0 6px 5px 0}.fb_connect_bar div a,.fb_connect_bar span,.fb_connect_bar span a{color:#bac6da;font-size:11px;text-decoration:none}.fb_connect_bar .fb_buttons{float:right;margin-top:7px}
.fbpluginrecommendationsbarleft,.fbpluginrecommendationsbarright{position:fixed !important;bottom:0;z-index:999}.fbpluginrecommendationsbarleft{left:10px}.fbpluginrecommendationsbarright{right:10px}</style></head>
		<body data-twttr-rendered="true" class="mediawiki ltr  sitedir-ltr"><iframe src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/hub.html" style="position: absolute; top: -9999em; width: 10px; height: 10px;" name="twttrHubFrameSecure" tabindex="0" allowtransparency="true" id="twttrHubFrameSecure" frameborder="0" scrolling="no"></iframe><iframe src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/hub_002.html" style="position: absolute; top: -9999em; width: 10px; height: 10px;" name="twttrHubFrame" tabindex="0" allowtransparency="true" id="twttrHubFrame" frameborder="0" scrolling="no"></iframe>
		
		<!-- MediaWiki:wikihowads_setup -->
<script type="text/javascript">
<!--
var WH=WH||{};WH.browserDetect=function(){var ua=navigator.userAgent.toLowerCase();is_ff=ua.indexOf('firefox')!=-1;is_safari=ua.indexOf('applewebkit')!=-1;is_chrome=ua.indexOf('chrome')!=-1;is_ie6=false;is_ie7=false;is_ie8=false;is_ie9=false;isiPad=ua.indexOf('ipad');isiPhone=ua.indexOf('iphone');if(/msie (\d+\.\d+);/.test(ua)){var iev=new Number(RegExp.$1);if(iev>=9)is_ie9=true;else if(iev>=8)is_ie8=true;else if(iev>=7)is_ie7=true;else if(iev>=6)is_ie6=true}};WH.isFromSearch=function(){var ref=document.referrer;if(ref.indexOf('https://www.google.com/')==0||(ref.indexOf('google.')!=-1&&ref.indexOf('mail.google.com')==-1&&ref.indexOf('url?q=')==-1&&ref.indexOf('q=')!=-1))return true;if(ref.indexOf('bing.com')!=-1&&ref.indexOf('q=')!=-1)return true;if(ref.indexOf('yahoo.com')!=-1&&ref.indexOf('p=')!=-1)return true;if(ref.indexOf('ask.com')!=-1&&ref.indexOf('q=')!=-1)return true;if(ref.indexOf('aol.com')!=-1&&ref.indexOf('q=')!=-1)return true;if(ref.indexOf('baidu.com')!=-1&&ref.indexOf('wd=')!=-1)return true;if(ref.indexOf('yandex.com')!=-1&&ref.indexOf('text=')!=-1)return true;return false};WH.wikihowAds=(function(){var adsSet=false,adArray={},adIndex=0,adUnitArray={},adCount={intro:1,'0':1,'1':3,'2':3,'2a':3,'5':1,'7':2,docviewer3:2},isHorizontal={'7':true,docviewer3:true}
function checkHideAds(){var ca=document.cookie.split(';');var hideAds=false;for(var i=0;i<ca.length;i++){var c=ca[i];var pair=c.split('=');var key=pair[0];var value=pair[1];key=key.replace(/ /,'');if(key=='wiki_hideads'){if(value=='1')hideAds=true}};return hideAds};return {checkHideAds:checkHideAds}})();WH.browserDetect();var fromsearch=WH.isFromSearch();var gHideAds=WH.wikihowAds.checkHideAds(),gchans='',radChan1='',radPos1='',adPadding='',adColor='',adUrl='',adTitle='',adText='',showImageAd=false,adNum=0;var missing_last_ads=false;var hasAltMethods=false;var gchans="";var rad=true;var xchannels='';var showImageAd=true;var abType=1;var r=Math.random();r=.2;var abType=0;if(r<=.25){abType=1;gchans+='+8729124971';google_font_face="ubuntu"}else if(r<=.5){abType=2;gchans+='+1205858175';google_font_face="lora"}else if(r<=.75){abType=3;gchans+='+2682591373';google_font_face="verdana"}else{abType=0;gchans+='+7252391770';google_font_face="arial"};if(fromsearch)document.write("<sty"+"le type='text/css'>.adunitintro{margin-top:10px;}</sty"+"le>");else document.write("<sty"+"le type='text/css'>.ad_labelintro{display:none;}#adjump {display:none;}</sty"+"le>");document.write("<sty"+"le type='text/css'>.adunit0, .adunit1, .ad_labelintro, .ad_label0, .ad_label1{margin-top:10px;} .wh_ad_inner{float:left;} </sty"+"le>");var isHHM='';if(isHHM=="1")showImageAd=false;if(is_ff>=0)gchans+="+0944676689";else if(is_chrome>=0)gchans+="+6585791357";else if(is_safari)gchans+="+0925121701";else if(is_ie6)gchans+="+5181221492";else if(is_ie7)gchans+="+3373262885";else if(is_ie8)gchans+="+2594021353";else if(is_ie9)gchans+="+1264837522";if(isiPad>=0)gchans+="+5756207113";if(fromsearch){gchans+="+3377966061";radChan1+="+3377966061"}else{gchans+="+9658161873";radChan1+="+9658161873"};if(!gHideAds){gchans+="+4744756494";radChan1+="+4744756494"}else google_max_num_ads='0';google_analytics_domain_name=".wikihow.com";google_ad_client="pub-9543332082073187";google_feedback='on';google_ad_region="test";google_ad_type='text'
//-->
</script><style type="text/css">.ad_labelintro{display:none;}#adjump {display:none;}</style><style type="text/css">.adunit0, .adunit1, .ad_labelintro, .ad_label0, .ad_label1{margin-top:10px;} .wh_ad_inner{float:left;} </style>		<div id="header_outer"><div id="header">
			<ul id="actions">
									<li id="nav_messages_li">
						<div class="nav_icon"></div>
						<a id="nav_messages" class="nav " href="#">MESSAGES</a>
											</li>
									<li id="nav_profile_li">
						<div class="nav_icon"></div>
						<a id="nav_profile" class="nav " href="#">LOG IN</a>
						<div class="menu_login"><form name="userlogin" class="userlogin" method="post" action="https://ssl.wikihow.com/index.php?title=Special:Userlogin&amp;action=submitlogin&amp;type=login&amp;returnto=Create-a-Secure-Login-Script-in-PHP-and-MySQL&amp;sitelogin=1">
	
	<h3>Log in via</h3>
	<div id="fb_connect_head"><a id="fb_login_head" href="#"><span></span></a></div>
				<div data-gapiattached="true" id="gplus_connect_head"><a id="gplus_login_head" href="#"><span></span></a></div>		
	<div class="userlogin_inputs">
		<h3>Log In</h3>
		<input style="color: rgb(171, 171, 171);" class="loginText input_med" name="wpName" id="wpName1_head" value="Username or Email" size="20" type="text">
		<input id="wpName1_showhide_head" type="hidden"><br>
		
		<input style="color: rgb(171, 171, 171);" class="loginPassword input_med" name="wpPassword" id="wpPassword1_head" value="Password" size="20" type="text">
		<input id="wpPassword1_showhide_head" type="hidden">
	</div>

	<input class="button primary login_button" name="wpLoginattempt" id="wpLoginattempt" value="Log In" type="submit">

	<div class="userlogin_remember">
		<input name="wpRemember" value="1" id="wpRemember_head" checked="checked" type="checkbox"> 
		<label for="wpRemember_head">Remember me</label>
	</div>
	
	<div class="userlogin_links">
		<a href="http://www.wikihow.com/Special:LoginReminder" id="forgot_pwd_head">Forgot password?</a>
		<a href="https://ssl.wikihow.com/Special:Userlogin?type=signup">Create an account</a>
	</div>
</form>
</div>					</li>
									<li id="nav_explore_li">
						<div class="nav_icon"></div>
						<a id="nav_explore" class="nav " href="#">EXPLORE</a>
						<div class="menu"><a href="http://www.wikihow.com/Special:CommunityDashboard" title="Special:CommunityDashboard">Community Dashboard</a><a href="http://www.wikihow.com/Special:Randomizer">Random Article</a><a href="http://www.wikihow.com/wikiHow:About-wikiHow" title="wikiHow:About wikiHow">About Us</a><a href="http://www.wikihow.com/Special:Categorylisting" title="Special:Categorylisting">Categories</a><a href="http://www.wikihow.com/Special:RecentChanges" title="Special:RecentChanges">Recent Changes</a></div>					</li>
									<li id="nav_help_li">
						<div class="nav_icon"></div>
						<a id="nav_help" class="nav " href="#">HELP US</a>
						<div class="menu"><a href="http://www.wikihow.com/Special:CreatePage" title="Special:CreatePage">Write an Article</a><a href="http://www.wikihow.com/Special:RequestTopic" title="Special:RequestTopic">Request a New Article</a><a href="http://www.wikihow.com/Special:ListRequestedTopics" title="Special:ListRequestedTopics">Answer a Request</a><a href="http://www.wikihow.com/Special:CommunityDashboard">More Ideas...</a></div>					</li>
									<li id="nav_edit_li">
						<div class="nav_icon"></div>
						<a id="nav_edit" class="nav " href="http://www.wikihow.com/index.php?title=Create-a-Secure-Login-Script-in-PHP-and-MySQL&amp;action=edit">EDIT</a>
						<div class="menu"><a href="http://www.wikihow.com/index.php?title=Create-a-Secure-Login-Script-in-PHP-and-MySQL&amp;action=edit">Edit this Article</a></div>					</li>
							</ul><!--end actions-->
									<a href="http://www.wikihow.com/Main-Page" id="logo_link"><img src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/wikihow_logo.png" class="logo"></a>
			
<form action="/Special:GoogSearch" id="cse-search-box">
  <div>
    <input name="cx" value="008953293426798287586:mr-gwotjmbs" type="hidden">
    <input name="cof" value="FORID:10" type="hidden">
    <input name="ie" value="UTF-8" type="hidden">
    <input style="background: url(&quot;http://pad3.whstatic.com/skins/WikiHow/google_custom_search_watermark_en.gif&quot;) no-repeat scroll 8px center rgb(255, 255, 255);" id="cse_q" name="q" size="30" class="search_box" x-webkit-speech="" type="text">
    <input id="cse_sa" value="Search" class="search_button" onmouseover="button_swap(this);" onmouseout="button_unswap(this);" onclick='gatTrack("Search","Search","Custom_search");' type="submit">
  </div>
<input value="www.wikihow.com/Create-a-Secure-Login-Script-in-PHP-and-MySQL" name="siteurl" type="hidden"></form>
					</div></div><!--end header-->
				<div id="main_container" class="">
			<div id="header_space"></div>
		
		<div id="main">
				<div id="actionbar" class="">
							<div id="gatBreadCrumb">
					<ul id="breadcrumb" class="Breadcrumbs">
						<li class="home"><a href="http://www.wikihow.com/Main-Page" title="Main Page">Home</a></li> <li>» <a href="http://www.wikihow.com/Special:Categorylisting" title="Special:Categorylisting">Categories</a></li> <li> » <a href="http://www.wikihow.com/Category:Computers-and-Electronics" title="Category:Computers and Electronics">Computers and Electronics</a></li><li> » <a href="http://www.wikihow.com/Category:Software" title="Category:Software">Software</a></li><li> » <a href="http://www.wikihow.com/Category:Web-Programming" title="Category:Web Programming">Web Programming</a></li>					</ul>
				</div>
						<div id="article_tabs"><ul id="tabs"><li><a href="http://www.wikihow.com/Create-a-Secure-Login-Script-in-PHP-and-MySQL" class="on" id="tab_article">Article</a></li><li><a href="http://www.wikihow.com/index.php?title=Create-a-Secure-Login-Script-in-PHP-and-MySQL&amp;action=edit" class="" id="tab_edit">Edit</a></li><li><a href="http://www.wikihow.com/Discussion:Create-a-Secure-Login-Script-in-PHP-and-MySQL" class="" id="tab_discuss">Discuss</a></li></ul></div>
		</div><!--end actionbar-->
		<script>
		<!--
		WH.translationData = {'pt': {'msg':"<a href=\"http:\/\/pt.wikihow.com\/Criar-um-Script-de-Login-Seguro-em-PHP-e-MySQL?utm_source=enwikihow&utm_medium=translatedcta&utm_campaign=translated\">Gostaria de aprender <i>Como Criar um Script de Login Seguro em PHP e MySQL<\/i>? Leia sobre o assunto em portugu\u00eas!<\/a>"},'es': {'msg':"<a href=\"http:\/\/es.wikihow.com\/crear-un-script-de-inicio-de-sesi%C3%B3n-segura-en-php-y-MySQL?utm_source=enwikihow&utm_medium=translatedcta&utm_campaign=translated\">\u00bfTe gustar\u00eda saber <i>C\u00f3mo crear un script de inicio de sesi\u00f3n segura en php y MySQL<\/i>? \u00a1Lee acerca de eso en espa\u00f1ol!<\/a>"},'it': {'msg':"<a href=\"http:\/\/it.wikihow.com\/Creare-uno-Script-Sicuro-per-il-Login-Usando-PHP-e-MySQL?utm_source=enwikihow&utm_medium=translatedcta&utm_campaign=translated\">Ti piacerebbe sapere <i>Come Creare uno Script Sicuro per il Login Usando PHP e MySQL<\/i>? Leggi come farlo, in italiano!<\/a>"},'de': {'msg':"<a href=\"http:\/\/de.wikihow.com\/Ein-sicheres-Login-Skript-mit-PHP-und-MySQL-erstellen?utm_source=enwikihow&utm_medium=translatedcta&utm_campaign=translated\">Lies auch unseren deutschen Artikel: <i>Ein sicheres Login Skript mit PHP und MySQL erstellen<\/i>.<\/a>"},'fr': {'msg':"<a href=\"http:\/\/fr.wikihow.com\/cr%C3%A9er-un-script-de-connexion-s%C3%A9curis%C3%A9e-avec-PHP-et-MySQL?utm_source=enwikihow&utm_medium=translatedcta&utm_campaign=translated\">Voudriez-vous apprendre <i>Comment cr\u00e9er un script de connexion s\u00e9curis\u00e9e avec PHP et MySQL<\/i>? D\u00e9couvrez comment le faire en le lisant en fran\u00e7ais!<\/a>"}};
		//-->
		</script>
						
<script>
	WH.mergeLang({
'navlist_collapse': '- collapse','navlist_expand': '+ expand','usernameoremail': 'Username or Email','password': 'Password'
	});
</script>
		<div id="container" class="">
		<div id="article_shell">
		<div id="article">

									<div id="bodycontents">
<div style="" id="intro" class="section  sticky ">
<a href="http://www.wikihow.com/index.php?title=Create-a-Secure-Login-Script-in-PHP-and-MySQL&amp;action=edit" class="editsection">Edit Article</a><h1 class="firstHeading" itemprop="name"><a href="http://www.wikihow.com/Create-a-Secure-Login-Script-in-PHP-and-MySQL" itemprop="url">How to Create a Secure Login Script in PHP and MySQL</a></h1>
<p id="method_toc"><a href="#Configure_Your_Server" class="">Configure Your Server</a><a href="#Configure_the_MySQL_Database" class="">Configure the MySQL Database</a><a href="#Create_Database_Connection_Page" class="">Create Database Connection Page</a><a href="#Create_the_PHP_Functions" class="">Create the PHP Functions</a><a href="#Create_Processing_Pages" class="">Create Processing Pages</a><a href="#Create_Javascript_Files" class="">Create Javascript Files</a><a href="#Create_HTML_Pages" class="">Create HTML Pages</a><a href="#Protecting_Pages" class="">Protecting Pages</a></p>
<p id="originators">Edited by <span>Myles, Cased, The Guy Who Hates Hating, Nox</span> and 50 others</p>
<p>With more and more stories of cracking in the news, developers are 
looking for the best ways of securing their sites. If your site has a 
member system, it could be at risk from being cracked and your users' 
data could be compromised. This guide will show you one attempt at 
making a secure login using PHP. The code is as good as we can make it, 
but security and especially encryption are complex subjects that are 
changing all the time, and we can't claim to have the entire field 
mastered. Therefore we may have missed a few tricks in our code. If we 
have, please let us know and we'll try to incorporate any improvements 
into what we have.
Following this guide will help guard against many types of attack that 
crackers can use to gain control of other users' accounts, delete 
accounts and/or change data. Below is a list of possible attacks this 
guide tries to defend against:</p>
<ul>
<li><a rel="nofollow" class="external text" href="https://www.owasp.org/index.php/SQL_Injection">SQL Injections</a></li>
<li><a rel="nofollow" class="external text" href="https://www.owasp.org/index.php/Session_hijacking_attack">Session Hijacking</a></li>
<li><a rel="nofollow" class="external text" href="https://www.owasp.org/index.php/Network_Eavesdropping">Network Eavesdropping</a></li>
<li><a rel="nofollow" class="external text" href="https://www.owasp.org/index.php/Cross-site_Scripting_%28XSS%29">Cross Site Scripting</a></li>
<li><a rel="nofollow" class="external text" href="https://www.owasp.org/index.php/Blocking_Brute_Force_Attacks">Brute Force Attacks</a></li>
</ul>
<p>The approach is to use a mixture of data filtering, encryption and 
other methods to make the lives of the bad guys just that little bit 
more difficult.<br><br>
We're continually trying to improve this script. The <a rel="nofollow" class="external text" href="https://github.com/peredurabefrog/phpSecureLogin">very latest version of the code</a> is available from <a rel="nofollow" class="external text" href="https://github.com/peredurabefrog/phpSecureLogin">github</a>.
 There may be some differences between the code you download in this way
 from the code quoted in this article. You should also know that we have
 made no attempt to make the HTML pages output by the application look 
at all pretty.<br><br>
You may also notice that we do not close PHP tags in files containing 
only PHP code. This is in line with most code formatting 
recommendations.<br><br>
Finally, you need to know that we ask you to create all the 
application's non-HTML files in various directories within the 
application's root directory. The easiest way to get the correct 
directory structure is to download the latest code by following one of 
the links above.<br><br>
Please feel free to use this application as a basis for your own 
implementation, but don't use it as any kind of example of good coding 
practice!</p>
<br><p><br></p>
<br><p></p>
<br><p></p>
<div class="clearall"></div>
<div class="ad_label ad_label_side ad_labelintro">Ad</div>
<div class="wh_ad_inner adunitintro">
<script type="text/javascript">
<!--
<!-- MediaWiki:Adunitintro -->
	
google_ad_client = "ca-pub-9543332082073187";
/* iFrame Unit - intro */
//1 or normal
    google_ad_slot = '8579663774';

google_ad_width = 645;
google_ad_height = 120;
google_max_num_ads = 2;
google_ad_output = 'html';
google_override_format = true;
google_ad_channel = "0206790666+7733764704+1640266093+5860073694+6754085577+6876289738+7122150828" + gchans + xchannels;

if( fromsearch ) {
  document.write('<sc' + 'ript t' + 'ype="text/javascript" s' + 'rc="http://pagead2.googlesyndication.com/pagead/show_ads.js"></' + 'script>');
}

//-->
</script>
</div>
<div class="clearall adclear"></div>
</div>





<div style="" class="section thingsyoullneed  sticky ">
<h2><span class="mw-headline" id="Things_You.27ll_Need">Things You'll Need</span></h2>
<div id="thingsyoullneed" class="section_text">
<p>As we will be using the mysqli_* set of PHP classes to access our 
MySQL database you will need the following versions of PHP and mySQL.</p>
<ul>
<li><input id="item_ff0dcd18d3677ffc409d8d1fb4800892" class="css-checkbox" type="checkbox"><label for="item_ff0dcd18d3677ffc409d8d1fb4800892" name="item_ff0dcd18d3677ffc409d8d1fb4800892_lbl" class="css-checkbox-label"></label><div class="checkbox-text">PHP version 5.3 or later</div>
</li>
<li><input id="item_e2b79e79d364909ab0b1a9d73547c407" class="css-checkbox" type="checkbox"><label for="item_e2b79e79d364909ab0b1a9d73547c407" name="item_e2b79e79d364909ab0b1a9d73547c407_lbl" class="css-checkbox-label"></label><div class="checkbox-text">MySQL version 4.1.3 or later</div>
</li>
</ul>
<p>You will also need, of course, a web server configured to use PHP, to
 host your pages. This will most likely be your Web Host's web server, 
unless you are hosting the site yourself.<br><br>
To check the version of PHP and MySQL on your server use the <a rel="nofollow" class="external text" href="http://php.net/manual/en/function.phpinfo.php">phpinfo();</a> function.</p>
<div class="clearall"></div>
</div>
</div>


<h2 class="hidden"><span class="mw-headline" id="Steps">Steps</span></h2>
<div style="padding-top: 60px;" class="section steps   sticky ">
<h3>
<div class="altblock"></div>
<span class="mw-headline" id="Configure_Your_Server">Part 1 of 8: Configure Your Server</span>
</h3>
<div id="steps_1" class="section_text">
<ol class="steps_list_2">
<li>
<div class="step_num">1</div>
<b><b class="whb">Install a Web Server, PHP and MySQL on your server.</b></b><br><br>
Most web hosting services will have PHP and MySQL already installed. You
 will just have to check they have the most recent versions of PHP and 
MySQL for this guide to work. If they don't have at least PHP5.3 and 
MySQL5 you might like to ask a few questions about their commitment to 
security. Keeping your software up-to-date is a part of the security 
process.<br><br>
If you have your own server or computer, you should install the required
 software in the normal way for your system. Generally speaking, if you 
are not going to use the setup for production purposes and you are 
developing under Windows or OS/X, installing an XAMPP stack is the way 
to go. Get the appropriate version for your operating system at:<br><br><a rel="nofollow" class="external free" href="http://www.apachefriends.org/en/xampp.html">http://www.apachefriends.org/en/xampp.html</a><br><br>
But please note that you should under no circumstances use XAMPP to create a production server environment for you.<br><br>
Under Linux, use your package manager to download and install the 
necessary packages. Some distributions, like Ubuntu, package all the 
necessary applications into one bundle. Just do the following from a 
terminal window in Ubuntu:<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<p>sudo apt-get install lamp-server^ phpmyadmin</p>
</div>
<br><br>
However you install the necessary elements, please ensure you configure MySQL with a secure root password.<div class="clearall"></div>
<div class="ad_label ad_label0">Ad</div>
<div class="wh_ad_inner adunit0">
<script type="text/javascript">
<!--
<!-- MediaWiki:Adunit0 -->
	
google_ad_client = "ca-pub-9543332082073187";
/* iFrame Unit - First Step */
//a or normal
google_ad_slot = '5205564977';
    

google_ad_width = 600;
google_ad_height = 120;
google_max_num_ads = 2;
google_ad_output = 'html';
google_override_format = true;
google_ad_channel = "2748203808+7733764704+1640266093+5860073694+6754085577+7974857016+6876289738+7122150828" + gchans + xchannels;

document.write('<sc' + 'ript t' + 'ype="text/javascript" s' + 'rc="http://pagead2.googlesyndication.com/pagead/show_ads.js"></' + 'script>');


//-->
</script><script type="text/javascript" src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/show_ads.js"></script><ins style="display:inline-table;border:none;height:120px;margin:0;padding:0;position:relative;visibility:visible;width:600px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:120px;margin:0;padding:0;position:relative;visibility:visible;width:600px;background-color:transparent"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;" frameborder="0" height="120" scrolling="no" width="600"></iframe></ins></ins>
</div>
<div class="clearall adclear"></div>
</li>
</ol>
<div class="clearall"></div>
</div>
</div>
<div style="padding-top: 60px;" class="section steps   sticky ">
<h3>
<div class="altblock"></div>
<span class="mw-headline" id="Configure_the_MySQL_Database">Part 2 of 8: Configure the MySQL Database</span>
</h3>
<div id="steps_2" class="section_text">
<ol class="steps_list_2">
<li>
<div class="step_num">1</div>
<b><b class="whb">Create a MySQL database.</b></b><br><br>
Log into your database as an administrative user (usually root)<br><br>
In this guide we will create a database called "secure_login".<br><br>
See how to <a href="http://www.wikihow.com/Create-a-Database-in-Phpmyadmin" title="Create a Database in Phpmyadmin" class="mw-redirect">Create-a-Database-in-Phpmyadmin</a>.<br><br>
You can either use the code below or do the same thing in phpMyAdmin/your favourite GUI MySQL client, if you prefer:<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="sql source-sql">
<pre class="de1"><small><span class="kw1">CREATE</span> <span class="kw1">DATABASE</span> <span class="st0">`secure_login`</span>;</small>
</pre>
</div>
</div>
</div>
Note: Some hosting services don't allow you to create a database through phpMyAdmin, <a rel="nofollow" class="external text" href="http://www.interspire.com/content/2006/04/04/how-to-create-a-mysql-database-in-cpanel/">Learn how to do it in cPanel</a>.<div class="clearall"></div>
</li>
<li>
<div class="step_num">2</div>
<b><b class="whb">Create a user with only SELECT, UPDATE and INSERT privileges.</b></b><br><br>
Creating a user with restricted privileges means that if there was ever a
 breach of security in our script the hacker couldn't delete or drop 
anything from our database. Using these privileges, you can get by doing
 pretty much anything you would want to in your application. If you are 
really paranoid, create a different user for each function.<br><br>
Of course you will need to be logged into MySQL as a user with 
sufficient privileges in order to create a user. This user will usually 
be root.<br><br>
These are the details of the user we created:
<ul>
<li>
<b>User:</b> "sec_user"</li>
<li>
<b>Password:</b> "eKcGZr59zAa2BEWU"</li>
</ul>
<br>
Note: it is a good idea to change the password from the one given above 
when running on your own server. Make sure, if you do this, that you 
also change the code below, and your PHP database connection code in the
 application we are creating.<br><br>
Remember it doesn't need to be a password that you can remember so make it as complicated as possible. Here's a <a rel="nofollow" class="external text" href="http://www.random.org/passwords/">random password generator</a><br><br>
Given below is the SQL code for creating the database user and granting 
it the necessary permissions. Or you can do this in a GUI database 
client like phpmyadmin if you prefer:<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="sql source-sql">
<pre class="de1"><small><span class="kw1">CREATE</span> <span class="kw1">USER</span> <span class="st0">'sec_user'</span>@<span class="st0">'localhost'</span> <span class="kw1">IDENTIFIED</span> <span class="kw1">BY</span> <span class="st0">'eKcGZr59zAa2BEWU'</span>;
<span class="kw1">GRANT</span> <span class="kw1">SELECT</span><span class="sy0">,</span> <span class="kw1">INSERT</span><span class="sy0">,</span> <span class="kw1">UPDATE</span> <span class="kw1">ON</span> <span class="st0">`secure_login`</span><span class="sy0">.*</span> <span class="kw1">TO</span> <span class="st0">'sec_user'</span>@<span class="st0">'localhost'</span>;</small>
</pre>
</div>
</div>
</div>
<br><br>
If you see yourself deleting records from either of the tables in this 
module, you may want to add DELETE to the list of privileges, or you may
 prefer to create a different user with just the DELETE privilege, and 
only on the table from which you want to delete records if you don't 
want to delete from both. You do not need to grant DELETE privileges at 
all for anything in this example script.<div class="clearall"></div>
</li>
<li>
<div class="step_num">3</div>
<b><b class="whb">Create a MySQL table named "members".</b></b><br><br><p>The
 code below creates a table with five fields (id, username, email, 
password, salt). We use the CHAR datatype for fields we know the length 
of, as the fields "password" and "salt" will always be 128 characters 
long. Using CHAR here saves on processing power:<br><br></p>
<div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="sql source-sql">
<pre class="de1"><small><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> <span class="st0">`secure_login`</span><span class="sy0">.</span><span class="st0">`members`</span> <span class="br0">(</span>
    <span class="st0">`id`</span> <span class="kw1">INT</span> <span class="kw1">NOT</span> <span class="kw1">NULL</span> <span class="kw1">AUTO_INCREMENT</span> <span class="kw1">PRIMARY</span> <span class="kw1">KEY</span><span class="sy0">,</span>
    <span class="st0">`username`</span> <span class="kw1">VARCHAR</span><span class="br0">(</span><span class="nu0">30</span><span class="br0">)</span> <span class="kw1">NOT</span> <span class="kw1">NULL</span><span class="sy0">,</span>
    <span class="st0">`email`</span> <span class="kw1">VARCHAR</span><span class="br0">(</span><span class="nu0">50</span><span class="br0">)</span> <span class="kw1">NOT</span> <span class="kw1">NULL</span><span class="sy0">,</span>
    <span class="st0">`password`</span> <span class="kw1">CHAR</span><span class="br0">(</span><span class="nu0">128</span><span class="br0">)</span> <span class="kw1">NOT</span> <span class="kw1">NULL</span><span class="sy0">,</span>
    <span class="st0">`salt`</span> <span class="kw1">CHAR</span><span class="br0">(</span><span class="nu0">128</span><span class="br0">)</span> <span class="kw1">NOT</span> <span class="kw1">NULL</span> 
<span class="br0">)</span> ENGINE <span class="sy0">=</span> InnoDB;</small>
</pre>
</div>
</div>
</div>
<br>
As we've said before, you can do this in whatever type of client you prefer.<div class="clearall"></div>
</li>
<li>
<div class="step_num">4</div>
<b><b class="whb">Create a table to store login attempts.</b></b><br><br>
We will use this table to store login attempts for a user. This is one 
way in which we will make brute force attacks more difficult:<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="sql source-sql">
<pre class="de1"><small><span class="kw1">CREATE</span> <span class="kw1">TABLE</span> <span class="st0">`secure_login`</span><span class="sy0">.</span><span class="st0">`login_attempts`</span> <span class="br0">(</span>
    <span class="st0">`user_id`</span> <span class="kw1">INT</span><span class="br0">(</span><span class="nu0">11</span><span class="br0">)</span> <span class="kw1">NOT</span> <span class="kw1">NULL</span><span class="sy0">,</span>
    <span class="st0">`time`</span> <span class="kw1">VARCHAR</span><span class="br0">(</span><span class="nu0">30</span><span class="br0">)</span> <span class="kw1">NOT</span> <span class="kw1">NULL</span>
<span class="br0">)</span> ENGINE<span class="sy0">=</span>InnoDB</small>
</pre>
</div>
</div>
</div>
<br><div class="clearall"></div>
</li>
<li>
<div class="step_num">5</div>
<b><b class="whb">Create a test row in table "members".</b></b><br><br>
It will be important to be able to test your login script, so below is the script to create a user with known details:
<ul>
<li>
<b>Username:</b> test_user</li>
<li>
<b>Email:</b> test@example.com</li>
<li>
<b>Password:</b> 6ZaxN2Vzm9NUJT2y</li>
</ul>
<br>
The code you need in order to be able to log in as this user is:<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="sql source-sql">
<pre class="de1"><small><span class="kw1">INSERT</span> <span class="kw1">INTO</span> <span class="st0">`secure_login`</span><span class="sy0">.</span><span class="st0">`members`</span> <span class="kw1">VALUES</span><span class="br0">(</span><span class="nu0">1</span><span class="sy0">,</span> <span class="st0">'test_user'</span><span class="sy0">,</span> <span class="st0">'test@example.com'</span><span class="sy0">,</span>
<span class="st0">'00807432eae173f652f2064bdca1b61b290b52d40e429a7d295d76a71084aa96c0233b82f1feac45529e0726559645acaed6f3ae58a286b9f075916ebf66cacc'</span><span class="sy0">,</span>
<span class="st0">'f9aab579fc1b41ed0c44fe4ecdbfcdb4cb99b9023abb241a6db833288f4eea3c02f76e0d35204a8695077dcf81932aa59006423976224be0390395bae152d4ef'</span><span class="br0">)</span>;</small>
</pre>
</div>
</div>
</div>
<div class="clearall"></div>
</li>
</ol>
<div class="clearall"></div>
</div>
</div>
<div style="padding-top: 60px;" class="section steps   sticky ">
<h3>
<div class="altblock"></div>
<span class="mw-headline" id="Create_Database_Connection_Page">Part 3 of 8: Create Database Connection Page</span>
</h3>
<div id="steps_3" class="section_text">
<ol class="steps_list_2">
<li>
<div class="step_num">1</div>
<b><b class="whb">Create a global configurations page</b><br><br>
Create a folder called "includes" in the root directory of the application and then create a new PHP file in that directory.</b>
 Call it psl-config.php. In a production environment you'll probably 
want to locate this file and all your other include files, outside of 
the web server's document root. If you do that, and we strongly suggest 
that you do, you will need to alter your include or require statements 
as necessary, so that the application can find the include files.<br><br>
Locating your include files outside of the web server's document root 
means that your file cannot be located using a URL. So, if someone 
mistakenly dropped the 'php' extension, say, or messed up the file 
permissions the file still could not be displayed as text in a browser 
window.<br><br>
The file contains global configuration variables. Things like whether 
anyone can register, whether or not it's a secure (HTTPS) connection, 
and other stuff as well as the database details could also go here...<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="php source-php">
<pre class="de1"><small><span class="kw2">&lt;?php</span>
<span class="co4">/**
 * These are the database login details
 */</span>  
<span class="kw3">define</span><span class="br0">(</span><span class="st0">"HOST"</span><span class="sy0">,</span> <span class="st0">"localhost"</span><span class="br0">)</span><span class="sy0">;</span>     <span class="co1">// The host you want to connect to.</span>
<span class="kw3">define</span><span class="br0">(</span><span class="st0">"USER"</span><span class="sy0">,</span> <span class="st0">"sec_user"</span><span class="br0">)</span><span class="sy0">;</span>    <span class="co1">// The database username. </span>
<span class="kw3">define</span><span class="br0">(</span><span class="st0">"PASSWORD"</span><span class="sy0">,</span> <span class="st0">"4Fa98xkHVd2XmnfK"</span><span class="br0">)</span><span class="sy0">;</span>    <span class="co1">// The database password. </span>
<span class="kw3">define</span><span class="br0">(</span><span class="st0">"DATABASE"</span><span class="sy0">,</span> <span class="st0">"secure_login"</span><span class="br0">)</span><span class="sy0">;</span>    <span class="co1">// The database name.</span>
 
<span class="kw3">define</span><span class="br0">(</span><span class="st0">"CAN_REGISTER"</span><span class="sy0">,</span> <span class="st0">"any"</span><span class="br0">)</span><span class="sy0">;</span>
<span class="kw3">define</span><span class="br0">(</span><span class="st0">"DEFAULT_ROLE"</span><span class="sy0">,</span> <span class="st0">"member"</span><span class="br0">)</span><span class="sy0">;</span>
 
<span class="kw3">define</span><span class="br0">(</span><span class="st0">"SECURE"</span><span class="sy0">,</span> <span class="kw4">FALSE</span><span class="br0">)</span><span class="sy0">;</span>    <span class="co1">// FOR DEVELOPMENT ONLY!!!!</span></small>
</pre>
</div>
</div>
</div>
<div class="clearall"></div>
</li>
<li>
<div class="step_num">2</div>
<b><b class="whb">Create the database connection page</b><br><br>
This is the PHP code that we will use to connect to our mySQL database.</b>
 Create a new PHP file called db_connect.php in the application's 
includes directory and add the code below. You can then include the file
 onto any page you wish to connect to the database.<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="php source-php">
<pre class="de1"><small><span class="kw2">&lt;?php</span>
<span class="kw1">include_once</span> <span class="st_h">'psl-config.php'</span><span class="sy0">;</span>   <span class="co1">// As functions.php is not included</span>
<span class="re0">$mysqli</span> <span class="sy0">=</span> <span class="kw2">new</span> mysqli<span class="br0">(</span>HOST<span class="sy0">,</span> USER<span class="sy0">,</span> PASSWORD<span class="sy0">,</span> DATABASE<span class="br0">)</span><span class="sy0">;</span></small>
</pre>
</div>
</div>
</div>
<div class="clearall"></div>
</li>
</ol>
<div class="clearall"></div>
</div>
</div>
<div style="padding-top: 60px;" class="section steps   sticky ">
<h3>
<div class="altblock"></div>
<span class="mw-headline" id="Create_the_PHP_Functions">Part 4 of 8: Create the PHP Functions</span>
</h3>
<div id="steps_4" class="section_text">
<p class="lone_p">These functions will do all the processing of the 
login script. Add all of the functions to a page called functions.php in
 the includes directory of the application.<br></p>
<ol class="steps_list_2">
<li>
<div class="step_num">1</div>
<b><b class="whb">Securely start a PHP session.</b></b><br>
PHP sessions are known not to be secure, therefore it is important not 
just to put "session_start();" at the top of every page on which you 
want to use PHP sessions. We are going to create a function called 
"sec_session_start()", this will start a PHP session in a secure way. 
You should call this function at the top of any page in which you wish 
to access a PHP session variable. If you are really concerned about 
security and the privacy of your cookies, have a look at this article: <a href="http://www.wikihow.com/Create-a-Secure-Session-Managment-System-in-Php-and-Mysql" title="Create a Secure Session Managment System in Php and Mysql" class="mw-redirect">Create-a-Secure-Session-Managment-System-in-Php-and-Mysql</a>.<br><br>
This function makes your login script a whole lot more secure. It stops 
crackers accessing the session id cookie through JavaScript (for example
 in an XSS attack). Also the "session_regenerate_id()" function, which 
regenerates the session id on every page reload, helps prevent session 
hijacking. Note: If you are using HTTPS in your login application set 
the "$secure" variable to true. In a production environment it is 
essential that you use HTTPS.<br><br>
Create a new file called functions.php in your application's includes directory and add the following code to it:
<div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="php source-php">
<pre class="de1"><small><span class="kw2">&lt;?php</span>
<span class="kw1">include_once</span> <span class="st_h">'psl-config.php'</span><span class="sy0">;</span>
 
<span class="kw2">function</span> sec_session_start<span class="br0">(</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="re0">$session_name</span> <span class="sy0">=</span> <span class="st_h">'sec_session_id'</span><span class="sy0">;</span>   <span class="co1">// Set a custom session name</span>
    <span class="re0">$secure</span> <span class="sy0">=</span> SECURE<span class="sy0">;</span>
    <span class="co1">// This stops JavaScript being able to access the session id.</span>
    <span class="re0">$httponly</span> <span class="sy0">=</span> <span class="kw4">true</span><span class="sy0">;</span>
    <span class="co1">// Forces sessions to only use cookies.</span>
    <span class="kw1">if</span> <span class="br0">(</span><span class="kw3">ini_set</span><span class="br0">(</span><span class="st_h">'session.use_only_cookies'</span><span class="sy0">,</span> <span class="nu0">1</span><span class="br0">)</span> <span class="sy0">===</span> <span class="kw4">FALSE</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="kw3">header</span><span class="br0">(</span><span class="st0">"Location: ../error.php?err=Could not initiate a safe session (ini_set)"</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="kw3">exit</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
    <span class="co1">// Gets current cookies params.</span>
    <span class="re0">$cookieParams</span> <span class="sy0">=</span> <span class="kw3">session_get_cookie_params</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw3">session_set_cookie_params</span><span class="br0">(</span><span class="re0">$cookieParams</span><span class="br0">[</span><span class="st0">"lifetime"</span><span class="br0">]</span><span class="sy0">,</span>
        <span class="re0">$cookieParams</span><span class="br0">[</span><span class="st0">"path"</span><span class="br0">]</span><span class="sy0">,</span> 
        <span class="re0">$cookieParams</span><span class="br0">[</span><span class="st0">"domain"</span><span class="br0">]</span><span class="sy0">,</span> 
        <span class="re0">$secure</span><span class="sy0">,</span>
        <span class="re0">$httponly</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="co1">// Sets the session name to the one set above.</span>
    <span class="kw3">session_name</span><span class="br0">(</span><span class="re0">$session_name</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw3">session_start</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>            <span class="co1">// Start the PHP session </span>
    <span class="kw3">session_regenerate_id</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>    <span class="co1">// regenerated the session, delete the old one. </span>
<span class="br0">}</span></small>
</pre>
</div>
</div>
</div>
<div class="clearall"></div>
</li>
<li>
<div class="step_num">2</div>
<b><b class="whb">Create the Login Function.</b></b><br>
This function will check the email and password against the database. It
 will return true if there is a match. Add this function to your 
functions.php file:<br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="php source-php">
<pre class="de1"><small><span class="kw2">function</span> login<span class="br0">(</span><span class="re0">$email</span><span class="sy0">,</span> <span class="re0">$password</span><span class="sy0">,</span> <span class="re0">$mysqli</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="co1">// Using prepared statements means that SQL injection is not possible. </span>
    <span class="kw1">if</span> <span class="br0">(</span><span class="re0">$stmt</span> <span class="sy0">=</span> <span class="re0">$mysqli</span><span class="sy0">-&gt;</span><span class="me1">prepare</span><span class="br0">(</span><span class="st0">"SELECT id, username, password, salt 
        FROM members
       WHERE email = ?
        LIMIT 1"</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">bind_param</span><span class="br0">(</span><span class="st_h">'s'</span><span class="sy0">,</span> <span class="re0">$email</span><span class="br0">)</span><span class="sy0">;</span>  <span class="co1">// Bind "$email" to parameter.</span>
        <span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">execute</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>    <span class="co1">// Execute the prepared query.</span>
        <span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">store_result</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
 
        <span class="co1">// get variables from result.</span>
        <span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">bind_result</span><span class="br0">(</span><span class="re0">$user_id</span><span class="sy0">,</span> <span class="re0">$username</span><span class="sy0">,</span> <span class="re0">$db_password</span><span class="sy0">,</span> <span class="re0">$salt</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">fetch</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
 
        <span class="co1">// hash the password with the unique salt.</span>
        <span class="re0">$password</span> <span class="sy0">=</span> <span class="kw3">hash</span><span class="br0">(</span><span class="st_h">'sha512'</span><span class="sy0">,</span> <span class="re0">$password</span> <span class="sy0">.</span> <span class="re0">$salt</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="kw1">if</span> <span class="br0">(</span><span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">num_rows</span> <span class="sy0">==</span> <span class="nu0">1</span><span class="br0">)</span> <span class="br0">{</span>
            <span class="co1">// If the user exists we check if the account is locked</span>
            <span class="co1">// from too many login attempts </span>
 
            <span class="kw1">if</span> <span class="br0">(</span>checkbrute<span class="br0">(</span><span class="re0">$user_id</span><span class="sy0">,</span> <span class="re0">$mysqli</span><span class="br0">)</span> <span class="sy0">==</span> <span class="kw4">true</span><span class="br0">)</span> <span class="br0">{</span>
                <span class="co1">// Account is locked </span>
                <span class="co1">// Send an email to user saying their account is locked</span>
                <span class="kw1">return</span> <span class="kw4">false</span><span class="sy0">;</span>
            <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span>
                <span class="co1">// Check if the password in the database matches</span>
                <span class="co1">// the password the user submitted.</span>
                <span class="kw1">if</span> <span class="br0">(</span><span class="re0">$db_password</span> <span class="sy0">==</span> <span class="re0">$password</span><span class="br0">)</span> <span class="br0">{</span>
                    <span class="co1">// Password is correct!</span>
                    <span class="co1">// Get the user-agent string of the user.</span>
                    <span class="re0">$user_browser</span> <span class="sy0">=</span> <span class="re0">$_SERVER</span><span class="br0">[</span><span class="st_h">'HTTP_USER_AGENT'</span><span class="br0">]</span><span class="sy0">;</span>
                    <span class="co1">// XSS protection as we might print this value</span>
                    <span class="re0">$user_id</span> <span class="sy0">=</span> <span class="kw3">preg_replace</span><span class="br0">(</span><span class="st0">"/[^0-9]+/"</span><span class="sy0">,</span> <span class="st0">""</span><span class="sy0">,</span> <span class="re0">$user_id</span><span class="br0">)</span><span class="sy0">;</span>
                    <span class="re0">$_SESSION</span><span class="br0">[</span><span class="st_h">'user_id'</span><span class="br0">]</span> <span class="sy0">=</span> <span class="re0">$user_id</span><span class="sy0">;</span>
                    <span class="co1">// XSS protection as we might print this value</span>
                    <span class="re0">$username</span> <span class="sy0">=</span> <span class="kw3">preg_replace</span><span class="br0">(</span><span class="st0">"/[^a-zA-Z0-9_\-]+/"</span><span class="sy0">,</span> 
                                                                <span class="st0">""</span><span class="sy0">,</span> 
                                                                <span class="re0">$username</span><span class="br0">)</span><span class="sy0">;</span>
                    <span class="re0">$_SESSION</span><span class="br0">[</span><span class="st_h">'username'</span><span class="br0">]</span> <span class="sy0">=</span> <span class="re0">$username</span><span class="sy0">;</span>
                    <span class="re0">$_SESSION</span><span class="br0">[</span><span class="st_h">'login_string'</span><span class="br0">]</span> <span class="sy0">=</span> <span class="kw3">hash</span><span class="br0">(</span><span class="st_h">'sha512'</span><span class="sy0">,</span> 
                              <span class="re0">$password</span> <span class="sy0">.</span> <span class="re0">$user_browser</span><span class="br0">)</span><span class="sy0">;</span>
                    <span class="co1">// Login successful.</span>
                    <span class="kw1">return</span> <span class="kw4">true</span><span class="sy0">;</span>
                <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span>
                    <span class="co1">// Password is not correct</span>
                    <span class="co1">// We record this attempt in the database</span>
                    <span class="re0">$now</span> <span class="sy0">=</span> <span class="kw3">time</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
                    <span class="re0">$mysqli</span><span class="sy0">-&gt;</span><span class="me1">query</span><span class="br0">(</span><span class="st0">"INSERT INTO login_attempts(user_id, time)
                                    VALUES ('<span class="es4">$user_id</span>', '<span class="es4">$now</span>')"</span><span class="br0">)</span><span class="sy0">;</span>
                    <span class="kw1">return</span> <span class="kw4">false</span><span class="sy0">;</span>
                <span class="br0">}</span>
            <span class="br0">}</span>
        <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span>
            <span class="co1">// No user exists.</span>
            <span class="kw1">return</span> <span class="kw4">false</span><span class="sy0">;</span>
        <span class="br0">}</span>
    <span class="br0">}</span>
<span class="br0">}</span></small>
</pre>
</div>
</div>
</div>
<br><div class="clearall"></div>
</li>
<li>
<div class="step_num">3</div>
<b><b class="whb">The Brute Force Function.</b></b><br>
Brute force attacks are when a hacker tries thousands of different 
passwords on an account, either randomly generated passwords or from a 
dictionary. In our script if a user account has more than five failed 
logins their account is locked.<br><br>
Brute force attacks are hard to prevent. A few ways we can prevent them 
are using a CAPTCHA test, locking user accounts and adding a delay on 
failed logins, so the user cannot login for another thirty seconds.<br><br>
We strongly recommend using a CAPTCHA. As yet we have not implemented 
this functionality in the example code, but hope to do so in the near 
future, using <a rel="nofollow" class="external text" href="http://www.phpcaptcha.org/">SecureImage</a>, since it does not require registration. You may prefer something better known such as <a rel="nofollow" class="external text" href="https://developers.google.com/recaptcha/docs/php">reCAPTCHA</a> from Google.<br><br>
Whichever system you decide on, we suggest you only display the CAPTCHA 
image after two failed login attempts so as to avoid inconveniencing the
 user unnecessarily.<br><br>
When faced with the problem of brute force attacks, most developers 
simply block the IP address after a certain amount of failed logins. But
 there are many tools to automate the process of making attacks like 
these; and these tools can go through a series of proxies and even 
change the IP on each request. Blocking all these IP addresses could 
mean you're blocking legitimate users as well. In our code we'll log 
failed attempts and lock the user's account after five failed login 
attempts. This should trigger the sending of an email to the user with a
 reset link, but we have not implemented this in our code. Here is the 
code for the checkbrute() function at the time of writing. Add it to 
your functions.php code:<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="php source-php">
<pre class="de1"><small><span class="kw2">function</span> checkbrute<span class="br0">(</span><span class="re0">$user_id</span><span class="sy0">,</span> <span class="re0">$mysqli</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="co1">// Get timestamp of current time </span>
    <span class="re0">$now</span> <span class="sy0">=</span> <span class="kw3">time</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
 
    <span class="co1">// All login attempts are counted from the past 2 hours. </span>
    <span class="re0">$valid_attempts</span> <span class="sy0">=</span> <span class="re0">$now</span> <span class="sy0">-</span> <span class="br0">(</span><span class="nu0">2</span> <span class="sy0">*</span> <span class="nu0">60</span> <span class="sy0">*</span> <span class="nu0">60</span><span class="br0">)</span><span class="sy0">;</span>
 
    <span class="kw1">if</span> <span class="br0">(</span><span class="re0">$stmt</span> <span class="sy0">=</span> <span class="re0">$mysqli</span><span class="sy0">-&gt;</span><span class="me1">prepare</span><span class="br0">(</span><span class="st0">"SELECT time 
                             FROM login_attempts &lt;code&gt;&lt;pre&gt;
                             WHERE user_id = ? 
                            AND time &gt; '<span class="es4">$valid_attempts</span>'"</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">bind_param</span><span class="br0">(</span><span class="st_h">'i'</span><span class="sy0">,</span> <span class="re0">$user_id</span><span class="br0">)</span><span class="sy0">;</span>
 
        <span class="co1">// Execute the prepared query. </span>
        <span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">execute</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">store_result</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
 
        <span class="co1">// If there have been more than 5 failed logins </span>
        <span class="kw1">if</span> <span class="br0">(</span><span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">num_rows</span> <span class="sy0">&gt;</span> <span class="nu0">5</span><span class="br0">)</span> <span class="br0">{</span>
            <span class="kw1">return</span> <span class="kw4">true</span><span class="sy0">;</span>
        <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span>
            <span class="kw1">return</span> <span class="kw4">false</span><span class="sy0">;</span>
        <span class="br0">}</span>
    <span class="br0">}</span>
<span class="br0">}</span></small>
</pre>
</div>
</div>
</div>
<div class="clearall"></div>
</li>
<li>
<div class="step_num">4</div>
<b><b class="whb">Check logged in status.</b></b><br>
We do this by checking the "user_id" and the "login_string" SESSION 
variables. The "login_string" SESSION variable has the user's browser 
information hashed together with the password. We use the browser 
information because it is very unlikely that the user will change their 
browser mid-session. Doing this helps prevent session hijacking. Add 
this function to your functions.php file in the includes folder of your 
application:<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="php source-php">
<pre class="de1"><small><span class="kw2">function</span> login_check<span class="br0">(</span><span class="re0">$mysqli</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="co1">// Check if all session variables are set </span>
    <span class="kw1">if</span> <span class="br0">(</span><span class="kw3">isset</span><span class="br0">(</span><span class="re0">$_SESSION</span><span class="br0">[</span><span class="st_h">'user_id'</span><span class="br0">]</span><span class="sy0">,</span> 
                        <span class="re0">$_SESSION</span><span class="br0">[</span><span class="st_h">'username'</span><span class="br0">]</span><span class="sy0">,</span> 
                        <span class="re0">$_SESSION</span><span class="br0">[</span><span class="st_h">'login_string'</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
 
        <span class="re0">$user_id</span> <span class="sy0">=</span> <span class="re0">$_SESSION</span><span class="br0">[</span><span class="st_h">'user_id'</span><span class="br0">]</span><span class="sy0">;</span>
        <span class="re0">$login_string</span> <span class="sy0">=</span> <span class="re0">$_SESSION</span><span class="br0">[</span><span class="st_h">'login_string'</span><span class="br0">]</span><span class="sy0">;</span>
        <span class="re0">$username</span> <span class="sy0">=</span> <span class="re0">$_SESSION</span><span class="br0">[</span><span class="st_h">'username'</span><span class="br0">]</span><span class="sy0">;</span>
 
        <span class="co1">// Get the user-agent string of the user.</span>
        <span class="re0">$user_browser</span> <span class="sy0">=</span> <span class="re0">$_SERVER</span><span class="br0">[</span><span class="st_h">'HTTP_USER_AGENT'</span><span class="br0">]</span><span class="sy0">;</span>
 
        <span class="kw1">if</span> <span class="br0">(</span><span class="re0">$stmt</span> <span class="sy0">=</span> <span class="re0">$mysqli</span><span class="sy0">-&gt;</span><span class="me1">prepare</span><span class="br0">(</span><span class="st0">"SELECT password 
                                      FROM members 
                                      WHERE id = ? LIMIT 1"</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
            <span class="co1">// Bind "$user_id" to parameter. </span>
            <span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">bind_param</span><span class="br0">(</span><span class="st_h">'i'</span><span class="sy0">,</span> <span class="re0">$user_id</span><span class="br0">)</span><span class="sy0">;</span>
            <span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">execute</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>   <span class="co1">// Execute the prepared query.</span>
            <span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">store_result</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
 
            <span class="kw1">if</span> <span class="br0">(</span><span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">num_rows</span> <span class="sy0">==</span> <span class="nu0">1</span><span class="br0">)</span> <span class="br0">{</span>
                <span class="co1">// If the user exists get variables from result.</span>
                <span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">bind_result</span><span class="br0">(</span><span class="re0">$password</span><span class="br0">)</span><span class="sy0">;</span>
                <span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">fetch</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
                <span class="re0">$login_check</span> <span class="sy0">=</span> <span class="kw3">hash</span><span class="br0">(</span><span class="st_h">'sha512'</span><span class="sy0">,</span> <span class="re0">$password</span> <span class="sy0">.</span> <span class="re0">$user_browser</span><span class="br0">)</span><span class="sy0">;</span>
 
                <span class="kw1">if</span> <span class="br0">(</span><span class="re0">$login_check</span> <span class="sy0">==</span> <span class="re0">$login_string</span><span class="br0">)</span> <span class="br0">{</span>
                    <span class="co1">// Logged In!!!! </span>
                    <span class="kw1">return</span> <span class="kw4">true</span><span class="sy0">;</span>
                <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span>
                    <span class="co1">// Not logged in </span>
                    <span class="kw1">return</span> <span class="kw4">false</span><span class="sy0">;</span>
                <span class="br0">}</span>
            <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span>
                <span class="co1">// Not logged in </span>
                <span class="kw1">return</span> <span class="kw4">false</span><span class="sy0">;</span>
            <span class="br0">}</span>
        <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span>
            <span class="co1">// Not logged in </span>
            <span class="kw1">return</span> <span class="kw4">false</span><span class="sy0">;</span>
        <span class="br0">}</span>
    <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span>
        <span class="co1">// Not logged in </span>
        <span class="kw1">return</span> <span class="kw4">false</span><span class="sy0">;</span>
    <span class="br0">}</span>
<span class="br0">}</span></small>
</pre>
</div>
</div>
</div>
<div class="clearall"></div>
</li>
<li>
<div class="step_num">5</div>
<b><b class="whb">Sanitize URL from PHP_SELF</b><br>
This next function sanitizes the output from the PHP_SELF server variable.</b> It is a modificaton of a function of the same name used by the WordPress Content Management System:<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="php source-php">
<pre class="de1"><small><span class="kw2">function</span> esc_url<span class="br0">(</span><span class="re0">$url</span><span class="br0">)</span> <span class="br0">{</span>
 
    <span class="kw1">if</span> <span class="br0">(</span><span class="st_h">''</span> <span class="sy0">==</span> <span class="re0">$url</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="kw1">return</span> <span class="re0">$url</span><span class="sy0">;</span>
    <span class="br0">}</span>
 
    <span class="re0">$url</span> <span class="sy0">=</span> <span class="kw3">preg_replace</span><span class="br0">(</span><span class="st_h">'|[^a-z0-9-~+_.?#=!&amp;;,/:%@$\|*\'()\\x80-\\xff]|i'</span><span class="sy0">,</span> <span class="st_h">''</span><span class="sy0">,</span> <span class="re0">$url</span><span class="br0">)</span><span class="sy0">;</span>
 
    <span class="re0">$strip</span> <span class="sy0">=</span> <span class="kw3">array</span><span class="br0">(</span><span class="st_h">'%0d'</span><span class="sy0">,</span> <span class="st_h">'%0a'</span><span class="sy0">,</span> <span class="st_h">'%0D'</span><span class="sy0">,</span> <span class="st_h">'%0A'</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="re0">$url</span> <span class="sy0">=</span> <span class="br0">(</span>string<span class="br0">)</span> <span class="re0">$url</span><span class="sy0">;</span>
 
    <span class="re0">$count</span> <span class="sy0">=</span> <span class="nu0">1</span><span class="sy0">;</span>
    <span class="kw1">while</span> <span class="br0">(</span><span class="re0">$count</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="re0">$url</span> <span class="sy0">=</span> <span class="kw3">str_replace</span><span class="br0">(</span><span class="re0">$strip</span><span class="sy0">,</span> <span class="st_h">''</span><span class="sy0">,</span> <span class="re0">$url</span><span class="sy0">,</span> <span class="re0">$count</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
 
    <span class="re0">$url</span> <span class="sy0">=</span> <span class="kw3">str_replace</span><span class="br0">(</span><span class="st_h">';//'</span><span class="sy0">,</span> <span class="st_h">'://'</span><span class="sy0">,</span> <span class="re0">$url</span><span class="br0">)</span><span class="sy0">;</span>
 
    <span class="re0">$url</span> <span class="sy0">=</span> <span class="kw3">htmlentities</span><span class="br0">(</span><span class="re0">$url</span><span class="br0">)</span><span class="sy0">;</span>
 
    <span class="re0">$url</span> <span class="sy0">=</span> <span class="kw3">str_replace</span><span class="br0">(</span><span class="st_h">'&amp;amp;'</span><span class="sy0">,</span> <span class="st_h">'&amp;#038;'</span><span class="sy0">,</span> <span class="re0">$url</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="re0">$url</span> <span class="sy0">=</span> <span class="kw3">str_replace</span><span class="br0">(</span><span class="st0">"'"</span><span class="sy0">,</span> <span class="st_h">'&amp;#039;'</span><span class="sy0">,</span> <span class="re0">$url</span><span class="br0">)</span><span class="sy0">;</span>
 
    <span class="kw1">if</span> <span class="br0">(</span><span class="re0">$url</span><span class="br0">[</span><span class="nu0">0</span><span class="br0">]</span> <span class="sy0">!==</span> <span class="st_h">'/'</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="co1">// We're only interested in relative links from $_SERVER['PHP_SELF']</span>
        <span class="kw1">return</span> <span class="st_h">''</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span>
        <span class="kw1">return</span> <span class="re0">$url</span><span class="sy0">;</span>
    <span class="br0">}</span>
<span class="br0">}</span></small>
</pre>
</div>
</div>
</div>
<br><br>
The trouble with using the server variable unfiltered is that it can be 
used in a cross site scripting attack. Most references will simply tell 
you to filter it using htmlentities(), however even this appears not to 
be sufficient hence the belt and braces approach in this function.<br><br>
Others suggest leaving the action attribute of the form blank, or set to
 a null string. Doing this, though, leaves the form open to an <a rel="nofollow" class="external text" href="http://blog.andlabs.org/2010/03/bypassing-csrf-protections-with.html">iframe clickjacking attack</a>.<div class="clearall"></div>
</li>
</ol>
<div class="clearall"></div>
</div>
</div>

<div style="padding-top: 60px;" class="section steps   sticky ">
<h3>
<div class="altblock"></div>
<span class="mw-headline" id="Create_Processing_Pages">Part 5 of 8: Create Processing Pages</span>
</h3>
<div id="steps_5" class="section_text">
<ol class="steps_list_2">
<li>
<div class="step_num">1</div>
<b><b class="whb">Create the login processing page (process_login.</b>php)</b><br><br>
Create a file to process logins, called process_login.php in the 
application's includes directory. It goes in this directory because it 
contains no HTML markup.<br><br>
We will use the mysqli_* set of PHP functions as this is one of the most up-to-date mySQL extensions.<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="php source-php">
<pre class="de1"><small><span class="kw2">&lt;?php</span>
<span class="kw1">include_once</span> <span class="st_h">'db_connect.php'</span><span class="sy0">;</span>
<span class="kw1">include_once</span> <span class="st_h">'functions.php'</span><span class="sy0">;</span>
 
sec_session_start<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> <span class="co1">// Our custom secure way of starting a PHP session.</span>
 
<span class="kw1">if</span> <span class="br0">(</span><span class="kw3">isset</span><span class="br0">(</span><span class="re0">$_POST</span><span class="br0">[</span><span class="st_h">'email'</span><span class="br0">]</span><span class="sy0">,</span> <span class="re0">$_POST</span><span class="br0">[</span><span class="st_h">'p'</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="re0">$email</span> <span class="sy0">=</span> <span class="re0">$_POST</span><span class="br0">[</span><span class="st_h">'email'</span><span class="br0">]</span><span class="sy0">;</span>
    <span class="re0">$password</span> <span class="sy0">=</span> <span class="re0">$_POST</span><span class="br0">[</span><span class="st_h">'p'</span><span class="br0">]</span><span class="sy0">;</span> <span class="co1">// The hashed password.</span>
 
    <span class="kw1">if</span> <span class="br0">(</span>login<span class="br0">(</span><span class="re0">$email</span><span class="sy0">,</span> <span class="re0">$password</span><span class="sy0">,</span> <span class="re0">$mysqli</span><span class="br0">)</span> <span class="sy0">==</span> <span class="kw4">true</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="co1">// Login success </span>
        <span class="kw3">header</span><span class="br0">(</span><span class="st_h">'Location: ../protected_page.php'</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span>
        <span class="co1">// Login failed </span>
        <span class="kw3">header</span><span class="br0">(</span><span class="st_h">'Location: ../index.php?error=1'</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
<span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span>
    <span class="co1">// The correct POST variables were not sent to this page. </span>
    <span class="kw1">echo</span> <span class="st_h">'Invalid Request'</span><span class="sy0">;</span>
<span class="br0">}</span></small>
</pre>
</div>
</div>
</div>
<div class="clearall"></div>
</li>
<li>
<div class="step_num">2</div>
<b><b class="whb">Create a logout script.</b></b><br><br>
Your logout script must start the session, destroy it and then redirect 
to somewhere else. Note: it might be a good idea to add CSRF protection 
here in case someone sends a link hidden in this page somehow. For more 
information about CSRF you could visit <a rel="nofollow" class="external text" href="http://www.codinghorror.com/blog/2008/10/preventing-csrf-and-xsrf-attacks.html">Coding Horror</a>.<br><br>
The current code for logging out the user, which you should add to a 
file called logout.php in the application's includes directory, is:<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="php source-php">
<pre class="de1"><small><span class="kw2">&lt;?php</span>
<span class="kw1">include_once</span> <span class="st_h">'includes/functions.php'</span><span class="sy0">;</span>
sec_session_start<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
 
<span class="co1">// Unset all session values </span>
<span class="re0">$_SESSION</span> <span class="sy0">=</span> <span class="kw3">array</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
 
<span class="co1">// get session parameters </span>
<span class="re0">$params</span> <span class="sy0">=</span> <span class="kw3">session_get_cookie_params</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
 
<span class="co1">// Delete the actual cookie. </span>
<span class="kw3">setcookie</span><span class="br0">(</span><span class="kw3">session_name</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">,</span>
        <span class="st_h">''</span><span class="sy0">,</span> <span class="kw3">time</span><span class="br0">(</span><span class="br0">)</span> <span class="sy0">-</span> <span class="nu0">42000</span><span class="sy0">,</span> 
        <span class="re0">$params</span><span class="br0">[</span><span class="st0">"path"</span><span class="br0">]</span><span class="sy0">,</span> 
        <span class="re0">$params</span><span class="br0">[</span><span class="st0">"domain"</span><span class="br0">]</span><span class="sy0">,</span> 
        <span class="re0">$params</span><span class="br0">[</span><span class="st0">"secure"</span><span class="br0">]</span><span class="sy0">,</span> 
        <span class="re0">$params</span><span class="br0">[</span><span class="st0">"httponly"</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span>
 
<span class="co1">// Destroy session </span>
<span class="kw3">session_destroy</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
<span class="kw3">header</span><span class="br0">(</span><span class="st_h">'Location: ../ index.php'</span><span class="br0">)</span><span class="sy0">;</span></small>
</pre>
</div>
</div>
</div>
<div class="clearall"></div>
</li>
<li>
<div class="step_num">3</div>
<b><b class="whb">Registration Page.</b></b><br><br>
The registration code is included in two new files, called register.php 
in the application's root directory and register.inc.php in the includes
 directory. It does the following things:<br><ul>
<li>Obtains and validates the username the user wishes to adopt</li>
<li>Obtains and validates the user's email address</li>
<li>Obtains and validates the password the user wants to use</li>
<li>Hashes the password and passes it back to the register.php page (i.e. it posts to itself)</li>
</ul>
<br>
Most of the validation is done in JavaScript, client side. This is 
because the user has no motivation to circumvent these checks. Why would
 a user want to create an account that would be less secure than 
otherwise? We will discuss the JavaScript in the next section.<br><br>
For now, just create the register.php file and include the following code in it:<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="php source-php">
<pre class="de1"><small><span class="kw2">&lt;?php</span>
<span class="kw1">include_once</span> <span class="st_h">'includes/register.inc.php'</span><span class="sy0">;</span>
<span class="kw1">include_once</span> <span class="st_h">'includes/functions.php'</span><span class="sy0">;</span>
<span class="sy1">?&gt;</span>
&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;Secure Login: Registration Form&lt;/title&gt;
        &lt;script type="text/JavaScript" src="js/sha512.js"&gt;&lt;/script&gt; 
        &lt;script type="text/JavaScript" src="js/forms.js"&gt;&lt;/script&gt;
        &lt;link rel="stylesheet" href="styles/main.css" /&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;!-- Registration form to be output if the POST variables are not
        set or if the registration script caused an error. --&gt;
        &lt;h1&gt;Register with us&lt;/h1&gt;
        <span class="kw2">&lt;?php</span>
        <span class="kw1">if</span> <span class="br0">(</span><span class="sy0">!</span><span class="kw3">empty</span><span class="br0">(</span><span class="re0">$error_msg</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
            <span class="kw1">echo</span> <span class="re0">$error_msg</span><span class="sy0">;</span>
        <span class="br0">}</span>
        <span class="sy1">?&gt;</span>
        &lt;ul&gt;
            &lt;li&gt;Usernames may contain only digits, upper and lower case letters and underscores&lt;/li&gt;
            &lt;li&gt;Emails must have a valid email format&lt;/li&gt;
            &lt;li&gt;Passwords must be at least 6 characters long&lt;/li&gt;
            &lt;li&gt;Passwords must contain
                &lt;ul&gt;
                    &lt;li&gt;At least one upper case letter (A..Z)&lt;/li&gt;
                    &lt;li&gt;At least one lower case letter (a..z)&lt;/li&gt;
                    &lt;li&gt;At least one number (0..9)&lt;/li&gt;
                &lt;/ul&gt;
            &lt;/li&gt;
            &lt;li&gt;Your password and confirmation must match exactly&lt;/li&gt;
        &lt;/ul&gt;
        &lt;form action="<span class="kw2">&lt;?php</span> <span class="kw1">echo</span> esc_url<span class="br0">(</span><span class="re0">$_SERVER</span><span class="br0">[</span><span class="st_h">'PHP_SELF'</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span> <span class="sy1">?&gt;</span>" 
                method="post" 
                name="registration_form"&gt;
            Username: &lt;input type='text' 
                name='username' 
                id='username' /&gt;&lt;br&gt;
            Email: &lt;input type="text" name="email" id="email" /&gt;&lt;br&gt;
            Password: &lt;input type="password"
                             name="password" 
                             id="password"/&gt;&lt;br&gt;
            Confirm password: &lt;input type="password" 
                                     name="confirmpwd" 
                                     id="confirmpwd" /&gt;&lt;br&gt;
            &lt;input type="button" 
                   value="Register" 
                   onclick="return regformhash(this.form,
                                   this.form.username,
                                   this.form.email,
                                   this.form.password,
                                   this.form.confirmpwd);" /&gt; 
        &lt;/form&gt;
        &lt;p&gt;Return to the &lt;a href="index.php"&gt;login page&lt;/a&gt;.&lt;/p&gt;
    &lt;/body&gt;
&lt;/html&gt;</small>
</pre>
</div>
</div>
</div>
<br><br>
The register.inc.php file in the includes directory should contain the following code:<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="php source-php">
<pre class="de1"><small><span class="kw2">&lt;?php</span>
<span class="kw1">include_once</span> <span class="st_h">'db_connect.php'</span><span class="sy0">;</span>
<span class="kw1">include_once</span> <span class="st_h">'psl-config.php'</span><span class="sy0">;</span>
 
<span class="re0">$error_msg</span> <span class="sy0">=</span> <span class="st0">""</span><span class="sy0">;</span>
 
<span class="kw1">if</span> <span class="br0">(</span><span class="kw3">isset</span><span class="br0">(</span><span class="re0">$_POST</span><span class="br0">[</span><span class="st_h">'username'</span><span class="br0">]</span><span class="sy0">,</span> <span class="re0">$_POST</span><span class="br0">[</span><span class="st_h">'email'</span><span class="br0">]</span><span class="sy0">,</span> <span class="re0">$_POST</span><span class="br0">[</span><span class="st_h">'p'</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="co1">// Sanitize and validate the data passed in</span>
    <span class="re0">$username</span> <span class="sy0">=</span> <span class="kw3">filter_input</span><span class="br0">(</span>INPUT_POST<span class="sy0">,</span> <span class="st_h">'username'</span><span class="sy0">,</span> FILTER_SANITIZE_STRING<span class="br0">)</span><span class="sy0">;</span>
    <span class="re0">$email</span> <span class="sy0">=</span> <span class="kw3">filter_input</span><span class="br0">(</span>INPUT_POST<span class="sy0">,</span> <span class="st_h">'email'</span><span class="sy0">,</span> FILTER_SANITIZE_EMAIL<span class="br0">)</span><span class="sy0">;</span>
    <span class="re0">$email</span> <span class="sy0">=</span> <span class="kw3">filter_var</span><span class="br0">(</span><span class="re0">$email</span><span class="sy0">,</span> FILTER_VALIDATE_EMAIL<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">if</span> <span class="br0">(</span><span class="sy0">!</span><span class="kw3">filter_var</span><span class="br0">(</span><span class="re0">$email</span><span class="sy0">,</span> FILTER_VALIDATE_EMAIL<span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="co1">// Not a valid email</span>
        <span class="re0">$error_msg</span> <span class="sy0">.=</span> <span class="st_h">'&lt;p class="error"&gt;The email address you entered is not valid&lt;/p&gt;'</span><span class="sy0">;</span>
    <span class="br0">}</span>
 
    <span class="re0">$password</span> <span class="sy0">=</span> <span class="kw3">filter_input</span><span class="br0">(</span>INPUT_POST<span class="sy0">,</span> <span class="st_h">'p'</span><span class="sy0">,</span> FILTER_SANITIZE_STRING<span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">if</span> <span class="br0">(</span><span class="kw3">strlen</span><span class="br0">(</span><span class="re0">$password</span><span class="br0">)</span> <span class="sy0">!=</span> <span class="nu0">128</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="co1">// The hashed pwd should be 128 characters long.</span>
        <span class="co1">// If it's not, something really odd has happened</span>
        <span class="re0">$error_msg</span> <span class="sy0">.=</span> <span class="st_h">'&lt;p class="error"&gt;Invalid password configuration.&lt;/p&gt;'</span><span class="sy0">;</span>
    <span class="br0">}</span>
 
    <span class="co1">// Username validity and password validity have been checked client side.</span>
    <span class="co1">// This should should be adequate as nobody gains any advantage from</span>
    <span class="co1">// breaking these rules.</span>
    <span class="co1">//</span>
 
    <span class="re0">$prep_stmt</span> <span class="sy0">=</span> <span class="st0">"SELECT id FROM members WHERE email = ? LIMIT 1"</span><span class="sy0">;</span>
    <span class="re0">$stmt</span> <span class="sy0">=</span> <span class="re0">$mysqli</span><span class="sy0">-&gt;</span><span class="me1">prepare</span><span class="br0">(</span><span class="re0">$prep_stmt</span><span class="br0">)</span><span class="sy0">;</span>
 
    <span class="kw1">if</span> <span class="br0">(</span><span class="re0">$stmt</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">bind_param</span><span class="br0">(</span><span class="st_h">'s'</span><span class="sy0">,</span> <span class="re0">$email</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">execute</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">store_result</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
 
        <span class="kw1">if</span> <span class="br0">(</span><span class="re0">$stmt</span><span class="sy0">-&gt;</span><span class="me1">num_rows</span> <span class="sy0">==</span> <span class="nu0">1</span><span class="br0">)</span> <span class="br0">{</span>
            <span class="co1">// A user with this email address already exists</span>
            <span class="re0">$error_msg</span> <span class="sy0">.=</span> <span class="st_h">'&lt;p class="error"&gt;A user with this email address already exists.&lt;/p&gt;'</span><span class="sy0">;</span>
        <span class="br0">}</span>
    <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span>
        <span class="re0">$error_msg</span> <span class="sy0">.=</span> <span class="st_h">'&lt;p class="error"&gt;Database error&lt;/p&gt;'</span><span class="sy0">;</span>
    <span class="br0">}</span>
 
    <span class="co1">// TODO: </span>
    <span class="co1">// We'll also have to account for the situation where the user doesn't have</span>
    <span class="co1">// rights to do registration, by checking what type of user is attempting to</span>
    <span class="co1">// perform the operation.</span>
 
    <span class="kw1">if</span> <span class="br0">(</span><span class="kw3">empty</span><span class="br0">(</span><span class="re0">$error_msg</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="co1">// Create a random salt</span>
        <span class="re0">$random_salt</span> <span class="sy0">=</span> <span class="kw3">hash</span><span class="br0">(</span><span class="st_h">'sha512'</span><span class="sy0">,</span> <span class="kw3">uniqid</span><span class="br0">(</span>openssl_random_pseudo_bytes<span class="br0">(</span><span class="nu0">16</span><span class="br0">)</span><span class="sy0">,</span> <span class="kw4">TRUE</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
 
        <span class="co1">// Create salted password </span>
        <span class="re0">$password</span> <span class="sy0">=</span> <span class="kw3">hash</span><span class="br0">(</span><span class="st_h">'sha512'</span><span class="sy0">,</span> <span class="re0">$password</span> <span class="sy0">.</span> <span class="re0">$random_salt</span><span class="br0">)</span><span class="sy0">;</span>
 
        <span class="co1">// Insert the new user into the database </span>
        <span class="kw1">if</span> <span class="br0">(</span><span class="re0">$insert_stmt</span> <span class="sy0">=</span> <span class="re0">$mysqli</span><span class="sy0">-&gt;</span><span class="me1">prepare</span><span class="br0">(</span><span class="st0">"INSERT INTO members (username, email, password, salt) VALUES (?, ?, ?, ?)"</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
            <span class="re0">$insert_stmt</span><span class="sy0">-&gt;</span><span class="me1">bind_param</span><span class="br0">(</span><span class="st_h">'ssss'</span><span class="sy0">,</span> <span class="re0">$username</span><span class="sy0">,</span> <span class="re0">$email</span><span class="sy0">,</span> <span class="re0">$password</span><span class="sy0">,</span> <span class="re0">$random_salt</span><span class="br0">)</span><span class="sy0">;</span>
            <span class="co1">// Execute the prepared query.</span>
            <span class="kw1">if</span> <span class="br0">(</span><span class="sy0">!</span> <span class="re0">$insert_stmt</span><span class="sy0">-&gt;</span><span class="me1">execute</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
                <span class="kw3">header</span><span class="br0">(</span><span class="st_h">'Location: ../error.php?err=Registration failure: INSERT'</span><span class="br0">)</span><span class="sy0">;</span>
            <span class="br0">}</span>
        <span class="br0">}</span>
        <span class="kw3">header</span><span class="br0">(</span><span class="st_h">'Location: ./register_success.php'</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="br0">}</span>
<span class="br0">}</span></small>
</pre>
</div>
</div>
</div>
<br><br><p>If there is no POST data passed into the form, the 
registration form is displayed. The form's submit button calls the 
JavaScript function regformhash(). This function does the necessary 
validation checks and submits the form when all is well. The JavaScript 
functions are discussed in the next section.<br><br>
If the POST data exists, some server side checks are done to sanitise 
and validate it. NOTE that these checks are not complete at the time of 
writing. Some of the issues are mentioned in the comments in the file. 
At present, we just check that the email address is in the correct 
format, that the hashed password is the correct length and that the user
 is not trying to register an email that has already been registered.<br><br>
If everything checks out, the new user is registered by writing a new record into the members table.<br></p>
<div class="clearall"></div>
</li>
</ol>
<div class="clearall"></div>
</div>
</div>
<div style="padding-top: 60px;" class="section steps   sticky ">
<h3>
<div class="altblock"></div>
<span class="mw-headline" id="Create_Javascript_Files">Part 6 of 8: Create Javascript Files</span>
</h3>
<div id="steps_6" class="section_text">
<ol class="steps_list_2">
<li>
<div class="step_num">1</div>
<b><b class="whb">Create sha512.</b>js file</b><br><br>
This file is an implementation in JavaScript of the hashing algorithm 
sha512. We will use the hashing function so our passwords don't get sent
 in plain text.<br><br>
The file can be downloaded from <a rel="nofollow" class="external text" href="http://pajhome.org.uk/crypt/md5/sha512.html">pajhome.org.uk</a><br><br>
(It is also saved in the github repository)<br><br>
Store your copy of this file in a directory called "js", off the root directory of the application.<br><br><div class="clearall"></div>
</li>
<li>
<div class="step_num">2</div>
<b><b class="whb">Create forms.</b>js file</b><br>
This file, which you should create in the js directory of the 
application, will handle the hashing of the passwords for the login 
(formhash()) and registration (regformhash()) forms:<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="javascript source-javascript">
<pre class="de1"><small><span class="kw1">function</span> formhash<span class="br0">(</span>form<span class="sy0">,</span> password<span class="br0">)</span> <span class="br0">{</span>
    <span class="co1">// Create a new element input, this will be our hashed password field. </span>
    <span class="kw1">var</span> p <span class="sy0">=</span> document.<span class="me1">createElement</span><span class="br0">(</span><span class="st0">"input"</span><span class="br0">)</span><span class="sy0">;</span>
 
    <span class="co1">// Add the new element to our form. </span>
    form.<span class="me1">appendChild</span><span class="br0">(</span>p<span class="br0">)</span><span class="sy0">;</span>
    p.<span class="me1">name</span> <span class="sy0">=</span> <span class="st0">"p"</span><span class="sy0">;</span>
    p.<span class="me1">type</span> <span class="sy0">=</span> <span class="st0">"hidden"</span><span class="sy0">;</span>
    p.<span class="me1">value</span> <span class="sy0">=</span> hex_sha512<span class="br0">(</span>password.<span class="me1">value</span><span class="br0">)</span><span class="sy0">;</span>
 
    <span class="co1">// Make sure the plaintext password doesn't get sent. </span>
    password.<span class="me1">value</span> <span class="sy0">=</span> <span class="st0">""</span><span class="sy0">;</span>
 
    <span class="co1">// Finally submit the form. </span>
    form.<span class="me1">submit</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
<span class="br0">}</span>
 
<span class="kw1">function</span> regformhash<span class="br0">(</span>form<span class="sy0">,</span> uid<span class="sy0">,</span> email<span class="sy0">,</span> password<span class="sy0">,</span> conf<span class="br0">)</span> <span class="br0">{</span>
     <span class="co1">// Check each field has a value</span>
    <span class="kw1">if</span> <span class="br0">(</span>uid.<span class="me1">value</span> <span class="sy0">==</span> <span class="st0">''</span>         <span class="sy0">||</span> 
          email.<span class="me1">value</span> <span class="sy0">==</span> <span class="st0">''</span>     <span class="sy0">||</span> 
          password.<span class="me1">value</span> <span class="sy0">==</span> <span class="st0">''</span>  <span class="sy0">||</span> 
          conf.<span class="me1">value</span> <span class="sy0">==</span> <span class="st0">''</span><span class="br0">)</span> <span class="br0">{</span>
 
        alert<span class="br0">(</span><span class="st0">'You must provide all the requested details. Please try again'</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="kw1">return</span> <span class="kw2">false</span><span class="sy0">;</span>
    <span class="br0">}</span>
 
    <span class="co1">// Check the username</span>
 
    re <span class="sy0">=</span> <span class="co2">/^\w+$/</span><span class="sy0">;</span> 
    <span class="kw1">if</span><span class="br0">(</span><span class="sy0">!</span>re.<span class="me1">test</span><span class="br0">(</span>form.<span class="me1">username</span>.<span class="me1">value</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span> 
        alert<span class="br0">(</span><span class="st0">"Username must contain only letters, numbers and underscores. Please try again"</span><span class="br0">)</span><span class="sy0">;</span> 
        form.<span class="me1">username</span>.<span class="me1">focus</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="kw1">return</span> <span class="kw2">false</span><span class="sy0">;</span> 
    <span class="br0">}</span>
 
    <span class="co1">// Check that the password is sufficiently long (min 6 chars)</span>
    <span class="co1">// The check is duplicated below, but this is included to give more</span>
    <span class="co1">// specific guidance to the user</span>
    <span class="kw1">if</span> <span class="br0">(</span>password.<span class="me1">value</span>.<span class="me1">length</span> <span class="sy0">&lt;</span> <span class="nu0">6</span><span class="br0">)</span> <span class="br0">{</span>
        alert<span class="br0">(</span><span class="st0">'Passwords must be at least 6 characters long.  Please try again'</span><span class="br0">)</span><span class="sy0">;</span>
        form.<span class="me1">password</span>.<span class="me1">focus</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="kw1">return</span> <span class="kw2">false</span><span class="sy0">;</span>
    <span class="br0">}</span>
 
    <span class="co1">// At least one number, one lowercase and one uppercase letter </span>
    <span class="co1">// At least six characters </span>
 
    <span class="kw1">var</span> re <span class="sy0">=</span> <span class="co2">/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/</span><span class="sy0">;</span> 
    <span class="kw1">if</span> <span class="br0">(</span><span class="sy0">!</span>re.<span class="me1">test</span><span class="br0">(</span>password.<span class="me1">value</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
        alert<span class="br0">(</span><span class="st0">'Passwords must contain at least one number, one lowercase and one uppercase letter.  Please try again'</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="kw1">return</span> <span class="kw2">false</span><span class="sy0">;</span>
    <span class="br0">}</span>
 
    <span class="co1">// Check password and confirmation are the same</span>
    <span class="kw1">if</span> <span class="br0">(</span>password.<span class="me1">value</span> <span class="sy0">!=</span> conf.<span class="me1">value</span><span class="br0">)</span> <span class="br0">{</span>
        alert<span class="br0">(</span><span class="st0">'Your password and confirmation do not match. Please try again'</span><span class="br0">)</span><span class="sy0">;</span>
        form.<span class="me1">password</span>.<span class="me1">focus</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
        <span class="kw1">return</span> <span class="kw2">false</span><span class="sy0">;</span>
    <span class="br0">}</span>
 
    <span class="co1">// Create a new element input, this will be our hashed password field. </span>
    <span class="kw1">var</span> p <span class="sy0">=</span> document.<span class="me1">createElement</span><span class="br0">(</span><span class="st0">"input"</span><span class="br0">)</span><span class="sy0">;</span>
 
    <span class="co1">// Add the new element to our form. </span>
    form.<span class="me1">appendChild</span><span class="br0">(</span>p<span class="br0">)</span><span class="sy0">;</span>
    p.<span class="me1">name</span> <span class="sy0">=</span> <span class="st0">"p"</span><span class="sy0">;</span>
    p.<span class="me1">type</span> <span class="sy0">=</span> <span class="st0">"hidden"</span><span class="sy0">;</span>
    p.<span class="me1">value</span> <span class="sy0">=</span> hex_sha512<span class="br0">(</span>password.<span class="me1">value</span><span class="br0">)</span><span class="sy0">;</span>
 
    <span class="co1">// Make sure the plaintext password doesn't get sent. </span>
    password.<span class="me1">value</span> <span class="sy0">=</span> <span class="st0">""</span><span class="sy0">;</span>
    conf.<span class="me1">value</span> <span class="sy0">=</span> <span class="st0">""</span><span class="sy0">;</span>
 
    <span class="co1">// Finally submit the form. </span>
    form.<span class="me1">submit</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
    <span class="kw1">return</span> <span class="kw2">true</span><span class="sy0">;</span>
<span class="br0">}</span></small>
</pre>
</div>
</div>
</div>
<br><p>In both cases, the JavaScript hashes the password and passes it in the POST data by creating and populating a hidden field.</p>
<div class="clearall"></div>
</li>
</ol>
<div class="clearall"></div>
</div>
</div>
<div style="padding-top: 60px;" class="section steps   sticky ">
<h3>
<div class="altblock"></div>
<span class="mw-headline" id="Create_HTML_Pages">Part 7 of 8: Create HTML Pages</span>
</h3>
<div id="steps_7" class="section_text">
<ol class="steps_list_2">
<li>
<div class="step_num">1</div>
<b><b class="whb">Create the login form (login.</b>php).</b><br><br>
This is an HTML form with two text fields, named "email" and "password".
 The form's submit button calls the JavaScript function formhash(), 
which will generate a hash of the password, and send "email" and "p" 
(the hashed password) to the server. You should create this file in the 
application's root directory.<br><br>
When logging in, it is best to use something that is not public, for 
this guide we are using the email as the login id, the username can then
 be used to identify the user. If the email is not displayed on any 
pages within the wider application, it adds another unknown for anyone 
trying to crack the account.<br><br>
Note: even though we have encrypted the password so it is not sent in 
plain text, it is essential that you use the HTTPS protocol (TLS/SSL) 
when sending passwords in a production system. It cannot be stressed 
enough that simply hashing the password is not enough. A 
man-in-the-middle attack could be mounted to read the hash being sent 
and use it to log in.<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="php source-php">
<pre class="de1"><small><span class="kw2">&lt;?php</span>
<span class="kw1">include_once</span> <span class="st_h">'includes/db_connect.php'</span><span class="sy0">;</span>
<span class="kw1">include_once</span> <span class="st_h">'includes/functions.php'</span><span class="sy0">;</span>
 
sec_session_start<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
 
<span class="kw1">if</span> <span class="br0">(</span>login_check<span class="br0">(</span><span class="re0">$mysqli</span><span class="br0">)</span> <span class="sy0">==</span> <span class="kw4">true</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="re0">$logged</span> <span class="sy0">=</span> <span class="st_h">'in'</span><span class="sy0">;</span>
<span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span>
    <span class="re0">$logged</span> <span class="sy0">=</span> <span class="st_h">'out'</span><span class="sy0">;</span>
<span class="br0">}</span>
<span class="sy1">?&gt;</span>
&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Secure Login: Log In&lt;/title&gt;
        &lt;link rel="stylesheet" href="styles/main.css" /&gt;
        &lt;script type="text/JavaScript" src="js/sha512.js"&gt;&lt;/script&gt; 
        &lt;script type="text/JavaScript" src="js/forms.js"&gt;&lt;/script&gt; 
    &lt;/head&gt;
    &lt;body&gt;
        <span class="kw2">&lt;?php</span>
        <span class="kw1">if</span> <span class="br0">(</span><span class="kw3">isset</span><span class="br0">(</span><span class="re0">$_GET</span><span class="br0">[</span><span class="st_h">'error'</span><span class="br0">]</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
            <span class="kw1">echo</span> <span class="st_h">'&lt;p class="error"&gt;Error Logging In!&lt;/p&gt;'</span><span class="sy0">;</span>
        <span class="br0">}</span>
        <span class="sy1">?&gt;</span> 
        &lt;form action="includes/process_login.php" method="post" name="login_form"&gt;                      
            Email: &lt;input type="text" name="email" /&gt;
            Password: &lt;input type="password" 
                             name="password" 
                             id="password"/&gt;
            &lt;input type="button" 
                   value="Login" 
                   onclick="formhash(this.form, this.form.password);" /&gt; 
        &lt;/form&gt;
        &lt;p&gt;If you don't have a login, please &lt;a href="register.php"&gt;register&lt;/a&gt;&lt;/p&gt;
        &lt;p&gt;If you are done, please &lt;a href="includes/logout.php"&gt;log out&lt;/a&gt;.&lt;/p&gt;
        &lt;p&gt;You are currently logged <span class="kw2">&lt;?php</span> <span class="kw1">echo</span> <span class="re0">$logged</span> <span class="sy1">?&gt;</span>.&lt;/p&gt;
    &lt;/body&gt;
&lt;/html&gt;</small>
</pre>
</div>
</div>
</div>
<br><div class="clearall"></div>
</li>
<li>
<div class="step_num">2</div>
<b><b class="whb">Create the register_success.</b>php page</b><br><br>
Create a new PHP web page called register_success.php, in the root 
directory of the application. This is the page to which the user is 
redirected after successfully registering. Of course you can make this 
page anything you like or redirect to another page entirely (or even not
 at all). It's up to you. The page should be located in the root 
directory of the application. The current register_success.php page that
 we have written looks like this:<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="php source-php">
<pre class="de1"><small><span class="sy0">&lt;!</span>DOCTYPE html<span class="sy0">&gt;</span>
<span class="sy0">&lt;</span>html<span class="sy0">&gt;</span>
    <span class="sy0">&lt;</span>head<span class="sy0">&gt;</span>
        <span class="sy0">&lt;</span>meta charset<span class="sy0">=</span><span class="st0">"UTF-8"</span><span class="sy0">&gt;</span>
        <span class="sy0">&lt;</span>title<span class="sy0">&gt;</span>Secure Login<span class="sy0">:</span> Registration Success<span class="sy0">&lt;/</span>title<span class="sy0">&gt;</span>
        <span class="sy0">&lt;</span><span class="kw3">link</span> rel<span class="sy0">=</span><span class="st0">"stylesheet"</span> href<span class="sy0">=</span><span class="st0">"styles/main.css"</span> <span class="sy0">/&gt;</span>
    <span class="sy0">&lt;/</span>head<span class="sy0">&gt;</span>
    <span class="sy0">&lt;</span>body<span class="sy0">&gt;</span>
        <span class="sy0">&lt;</span>h1<span class="sy0">&gt;</span>Registration successful<span class="sy0">!&lt;/</span>h1<span class="sy0">&gt;</span>
        <span class="sy0">&lt;</span>p<span class="sy0">&gt;</span>You can now go back to the <span class="sy0">&lt;</span>a href<span class="sy0">=</span><span class="st0">"index.php"</span><span class="sy0">&gt;</span>login page<span class="sy0">&lt;/</span>a<span class="sy0">&gt;</span> and <span class="kw3">log</span> in<span class="sy0">&lt;/</span>p<span class="sy0">&gt;</span>
    <span class="sy0">&lt;/</span>body<span class="sy0">&gt;</span>
<span class="sy0">&lt;/</span>html<span class="sy0">&gt;</span></small>
</pre>
</div>
</div>
</div>
<br><div class="clearall"></div>
</li>
<li>
<div class="step_num">3</div><b class="whb">Create the error page<br><br>
Create a new HTML page in the root directory of the application.</b> 
Call it error.php This is the page to which users will be directed if an
 error occurs during the login or registration process, or when trying 
to establish a secure session. The code given below simply provides a 
bare bones error page. You will probably need something a bit more 
sophisticated. However, please note that the input into the page must be
 properly filtered to guard against XSS attacks. The example page code 
is:<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="php source-php">
<pre class="de1"><small><span class="kw2">&lt;?php</span>
<span class="re0">$error</span> <span class="sy0">=</span> <span class="kw3">filter_input</span><span class="br0">(</span>INPUT_GET<span class="sy0">,</span> <span class="st_h">'err'</span><span class="sy0">,</span> <span class="re0">$filter</span> <span class="sy0">=</span> FILTER_SANITIZE_STRING<span class="br0">)</span><span class="sy0">;</span>
 
<span class="kw1">if</span> <span class="br0">(</span><span class="sy0">!</span> <span class="re0">$error</span><span class="br0">)</span> <span class="br0">{</span>
    <span class="re0">$error</span> <span class="sy0">=</span> <span class="st_h">'Oops! An unknown error happened.'</span><span class="sy0">;</span>
<span class="br0">}</span>
<span class="sy1">?&gt;</span>
&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;Secure Login: Error&lt;/title&gt;
        &lt;link rel="stylesheet" href="styles/main.css" /&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;h1&gt;There was a problem&lt;/h1&gt;
        &lt;p class="error"&gt;<span class="kw2">&lt;?php</span> <span class="kw1">echo</span> <span class="re0">$error</span><span class="sy0">;</span> <span class="sy1">?&gt;</span>&lt;/p&gt;  
    &lt;/body&gt;
&lt;/html&gt;</small>
</pre>
</div>
</div>
</div>
<br><div class="clearall"></div>
</li>
</ol>
<div class="clearall"></div>
</div>
</div>
<div style="padding-top: 60px;" class="section steps   sticky ">
<h3>
<div class="altblock"></div>
<span class="mw-headline" id="Protecting_Pages">Part 8 of 8: Protecting Pages</span>
</h3>
<div id="steps_8" class="section_text">
<ol class="steps_list_2">
<li class="final_li">
<div class="step_num">1</div>
<b><b class="whb">Page Protection Script.</b></b><br><br>
One of the most common problems with authentication systems is the 
developer forgetting to check if the user is logged in. It is very 
important you use the code below on every protected page to check that 
the user is logged in. Make sure you use this function to check if the 
user is logged in.<br><br><div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="php source-php">
<pre class="de1"><small><span class="co1">// Include database connection and functions here.  See 3.1. </span>
sec_session_start<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> 
<span class="kw1">if</span><span class="br0">(</span>login_check<span class="br0">(</span><span class="re0">$mysqli</span><span class="br0">)</span> <span class="sy0">==</span> <span class="kw4">true</span><span class="br0">)</span> <span class="br0">{</span>
        <span class="co1">// Add your protected page content here!</span>
<span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span> 
        <span class="kw1">echo</span> <span class="st_h">'You are not authorized to access this page, please login.'</span><span class="sy0">;</span>
<span class="br0">}</span></small>
</pre>
</div>
</div>
</div>
<br><p>As an example of what you should do, we have included a sample 
protected page. Create a file called protected_page.php in the root 
directory of the application. The file should contain something like the
 following:<br><br></p>
<div style="background-color: #f6f5f4; border-style: dashed; border-width: 1px; border-color: #000000; padding-top: .5em; padding-bottom: .5em; padding-left: .5em; overflow: auto;margin-top:1em;margin-bottom:0.5em;border-radius: 4px;-moz-border-radius: 4px;-webkit-border-radius: 4px;border: 1px solid #000;">
<div dir="ltr" class="mw-geshi mw-code mw-content-ltr">
<div class="php source-php">
<pre class="de1"><small><span class="kw2">&lt;?php</span>
<span class="kw1">include_once</span> <span class="st_h">'includes/db_connect.php'</span><span class="sy0">;</span>
<span class="kw1">include_once</span> <span class="st_h">'includes/functions.php'</span><span class="sy0">;</span>
 
sec_session_start<span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
<span class="sy1">?&gt;</span>
&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta charset="UTF-8"&gt;
        &lt;title&gt;Secure Login: Protected Page&lt;/title&gt;
        &lt;link rel="stylesheet" href="styles/main.css" /&gt;
    &lt;/head&gt;
    &lt;body&gt;
        <span class="kw2">&lt;?php</span> <span class="kw1">if</span> <span class="br0">(</span>login_check<span class="br0">(</span><span class="re0">$mysqli</span><span class="br0">)</span> <span class="sy0">==</span> <span class="kw4">true</span><span class="br0">)</span> <span class="sy0">:</span> <span class="sy1">?&gt;</span>
            &lt;p&gt;Welcome <span class="kw2">&lt;?php</span> <span class="kw1">echo</span> <span class="kw3">htmlentities</span><span class="br0">(</span><span class="re0">$_SESSION</span><span class="br0">[</span><span class="st_h">'username'</span><span class="br0">]</span><span class="br0">)</span><span class="sy0">;</span> <span class="sy1">?&gt;</span>!&lt;/p&gt;
            &lt;p&gt;
                This is an example protected page.  To access this page, users
                must be logged in.  At some stage, we'll also check the role of
                the user, so pages will be able to determine the type of user
                authorised to access the page.
            &lt;/p&gt;
            &lt;p&gt;Return to &lt;a href="index.php"&gt;login page&lt;/a&gt;&lt;/p&gt;
        <span class="kw2">&lt;?php</span> <span class="kw1">else</span> <span class="sy0">:</span> <span class="sy1">?&gt;</span>
            &lt;p&gt;
                &lt;span class="error"&gt;You are not authorized to access this page.&lt;/span&gt; Please &lt;a href="index.php"&gt;login&lt;/a&gt;.
            &lt;/p&gt;
        <span class="kw2">&lt;?php</span> <span class="kw1">endif</span><span class="sy0">;</span> <span class="sy1">?&gt;</span>
    &lt;/body&gt;
&lt;/html&gt;</small>
</pre>
</div>
</div>
</div>
<br><p>Our application redirects to this page after a successful login. Your own implementation does not have to do this, of course.<br><br></p>
<div class="clearall"></div>
<div class="ad_label ad_label1">Ad</div>
<div class="wh_ad_inner adunit1">
<script type="text/javascript">
<!--
<!-- MediaWiki:Adunit1 -->
	
google_ad_client = "ca-pub-9543332082073187";
/* iFrame Unit - last step */
//a or normal
google_ad_slot = '7008858971';

google_ad_width = 600;
google_ad_height = 180;
google_ad_output = 'html';
google_override_format = true;
google_ad_channel = "4065666674+7733764704+1640266093+5860073694+6754085577+7974857016+6876289738+7122150828" + gchans + xchannels;
google_max_num_ads = 3;
google_ad_region = "test";


document.write('<sc' + 'ript t' + 'ype="text/javascript" s' + 'rc="http://pagead2.googlesyndication.com/pagead/show_ads.js"></' + 'script>');

//-->
</script><script type="text/javascript" src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/show_ads.js"></script><ins style="display:inline-table;border:none;height:180px;margin:0;padding:0;position:relative;visibility:visible;width:600px;background-color:transparent"><ins id="aswift_1_anchor" style="display:block;border:none;height:180px;margin:0;padding:0;position:relative;visibility:visible;width:600px;background-color:transparent"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;" frameborder="0" height="180" scrolling="no" width="600"></iframe></ins></ins>
</div>
<div class="clearall adclear"></div>
</li>
</ol>
<div class="clearall"></div>
</div>
</div>
<div style="" class="section altadder_section">
<form id="newaltmethod" action="#">
	<div id="altheader">
		Add your own method
	</div>
	<div id="newmethodcontainer">
		<input id="altmethod" class="inactive input_med" value="Name your method" type="text"><textarea id="altsteps" class="inactive input_med">Add your steps using an ordered list. For example:
1. Step one
2. Step two
3. Step three</textarea><a href="#" id="addalt" class="button primary">Save</a>
	</div>
</form>
</div>

<div style="" class="section tips  sticky ">
<h2><span class="mw-headline" id="Tips">Tips</span></h2>
<div id="tips" class="section_text">
<ul>
<li>Stay away from the md5() function in login scripts, the md5 hashing algorithm is now considered <a rel="nofollow" class="external text" href="http://en.wikipedia.org/wiki/MD5#Collision_vulnerabilities">insecure</a>.</li>
<li>With very few changes these example scripts can be modified to work with other SQL systems such as <a href="http://www.wikihow.com/Enable-SQLite-for-PHP-5.X-in-Windows" title="Enable SQLite for PHP 5.X in Windows">SQLite</a> or <a href="http://www.wikihow.com/Install-PostgreSQL-Using-the-Source-Code" title="Install PostgreSQL Using the Source Code">PostgreSQL</a>.</li>
<li>Use HTML and CSS to format the login form and output pages to your liking.</li>
<li>If you're wanting to use a different hashing algorithm rather than 
sha512, try Whirlpool. Avoid using Gost, sha1 (Unless thoroughly salted 
and in multiple iterations), and as already stated, md5. Encourage your 
users to create strong, unique passwords with both uppercase and 
lowercase letters, numbers, and symbols. Consider having your users 
create a separate login name from their username for added security.</li>
</ul>
<div class="ad_label ad_label2a">Ad</div>
<div class="wh_ad_inner adunit2a">
<script type="text/javascript">
<!--
<!-- MediaWiki:Adunit2a -->
	
google_ad_client = "ca-pub-9543332082073187";
/* iFrame Unit - tips */
//a or normal
google_ad_slot = '2533130178';
    
google_ad_width = 607;
google_ad_height = 180;
google_ad_output = 'html';
google_override_format = true;
google_ad_channel = "9206048113+7733764704+1640266093+5860073694+6754085577+7974857016+6876289738+7122150828" + gchans + xchannels;
google_max_num_ads = 3;
google_ad_region = "test";

document.write('<sc' + 'ript t' + 'ype="text/javascript" s' + 'rc="http://pagead2.googlesyndication.com/pagead/show_ads.js"></' + 'script>');

//-->
</script><script type="text/javascript" src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/show_ads.js"></script><ins style="display:inline-table;border:none;height:180px;margin:0;padding:0;position:relative;visibility:visible;width:607px;background-color:transparent"><ins id="aswift_2_anchor" style="display:block;border:none;height:180px;margin:0;padding:0;position:relative;visibility:visible;width:607px;background-color:transparent"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;" frameborder="0" height="180" scrolling="no" width="607"></iframe></ins></ins>
</div>
<div class="clearall adclear"></div>
<div class="clearall"></div>
</div>
</div>
<div style="" class="section warnings  sticky ">
<h2><span class="mw-headline" id="Warnings">Warnings</span></h2>
<div id="warnings" class="section_text">
<ul>
<li>The login page and the Registration page must use HTTPS. The scripts
 in this article do not force you to do this and, indeed, you may find 
it easier not to during development. But you should not use these 
scripts in a production environment unless you are using HTTPS.</li>
<li>Make sure that the user cannot see your PHP script, which may occur 
due to an incorrect server setup. There is a possibility of the users 
gathering information about your database names and passwords if your 
PHP code is visible. Ideally any scripts that are included in other 
scripts or pages should be located in a directory outside of the 
server's file system and referenced using a relative path e.g. include 
'../../includes/myscript.inc.php'.</li>
<li>Nothing is 100% secure. Remember to stay in tune with the latest security news to keep improving the security of your scripts.</li>
<li>The Anti Brute Force of this script, that locks a user account, can 
be misused very easily. We strongly recommend that you use an anti-brute
 force technique such as a CAPTCHA.</li>
<li>The use of a CAPTCHA on the login page is highly recommended to make
 brute force and DoS attacks more difficult. We recommend that the 
CAPTCHA appear on the form after two failed login attempts. This is not 
yet implemented in the example code.</li>
<li>You may get a better solution than this by using a framework such as
 Zend 2, Symfony or CakePHP. All of these frameworks have arrangements 
for secure sessions and modules to assist with the login process. You 
may also find you write better applications if you use a framework.</li>
</ul>
<div class="clearall"></div>
</div>
</div>
<div style="" class="section sourcesandcitations  sticky ">
<h2><span class="mw-headline" id="Sources_and_Citations">Sources and Citations</span></h2>
<div id="sourcesandcitations" class="section_text">
<ul>
<li>
<a rel="nofollow" class="external free" href="http://crackstation.net/hashing-security.htm">http://crackstation.net/hashing-security.htm</a> Password Hashing</li>
<li>
<a rel="nofollow" class="external free" href="https://www.owasp.org/index.php/SQL_Injection">https://www.owasp.org/index.php/SQL_Injection</a> Info on SQL Injection</li>
</ul>
<p><br></p>
<div class="clearall"></div>
</div>
</div>

<div style="" class="section relatedwikihows  sticky ">
<h2><span class="mw-headline" id="Related_wikiHows">Related wikiHows</span></h2>
<div id="relatedwikihows" class="section_text">
<div class="thumbnail" style="width:127px; height:120px;"><a href="http://www.wikihow.com/Create-HTML-Forms"><img src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/-crop-127-120-127px-Create-HTML-Forms-Step-5.jpg" alt=""><div class="text"><p>How to <br><span>Create HTML Forms</span></p></div></a></div>
<div class="thumbnail" style="width:127px; height:120px;"><a href="http://www.wikihow.com/Secure-Passwords-Before-Storing-in-Mysql"><img src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/-crop-127-120-127px-Secure-Passwords-Before-Storing-in-MySQL.jpg" alt=""><div class="text"><p>How to <br><span>Secure Passwords Before Storing in Mysql</span></p></div></a></div>
<div class="thumbnail" style="width:127px; height:120px;"><a href="http://www.wikihow.com/Install-WAMP"><img src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/-crop-127-120-127px-Install-WAMP-Step-10.jpg" alt=""><div class="text"><p>How to <br><span>Install WAMP</span></p></div></a></div>
<div class="thumbnail" style="width:127px; height:120px;"><a href="http://www.wikihow.com/Create-a-Basic-Login-Script-in-PHP"><img src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/-crop-127-120-127px-619305-5.jpg" alt=""><div class="text"><p>How to <br><span>Create a Basic Login Script in PHP</span></p></div></a></div>
<div class="thumbnail" style="width:127px; height:120px;"><a href="http://www.wikihow.com/Write-PHP-Scripts"><img src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/-crop-127-120-127px-5101-21.jpg" alt=""><div class="text"><p>How to <br><span>Write PHP Scripts</span></p></div></a></div>
<div class="thumbnail" style="width:127px; height:120px;"><a href="http://www.wikihow.com/Create-a-Secure-Session-Managment-System-in-Php-and-Mysql"><img src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/-crop-127-120-127px-Book_266.png" alt=""><div class="text"><p>How to <br><span>Create a Secure Session Managment System in Php and Mysql</span></p></div></a></div>
<div class="clearall"></div>
<div class="clearall"></div>
</div>
</div>
<!-- 
NewPP limit report
Parsed by app6.wikihow.com
CPU time usage: 1.258 seconds
Real time usage: 1.290 seconds
Preprocessor visited node count: 517/1000000
Preprocessor generated node count: 1262/1000000
Post‐expand include size: 9040/2097152 bytes
Template argument size: 990/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
--><!-- Saved in parser cache with key wikidb_112:pcache:idhash:642666-0!*!0!!en!*!* and timestamp 20140423032752
 -->
</div>
				<div style="" class="section">
											<h2 class="section_head" id="article_info_header"><span>Article Info</span></h2>
						<div id="article_info" class="section_text">
																								<p class="info"> Categories: <span dir="ltr"><a href="http://www.wikihow.com/Category:Web-Programming" title="Category:Web Programming">Web Programming</a></span></p>
												<p></p><p class="info">Recent edits by: MDK Productions, Connor, Steve</p><p></p>
													<p class="info">In other languages:</p>
							<p class="info">Português:&nbsp;<span><a href="http://pt.wikihow.com/Criar-um-Script-de-Login-Seguro-em-PHP-e-MySQL">Como Criar um Script de Login Seguro em PHP e MySQL</a><span>,&nbsp;Español:&nbsp;<span><a href="http://es.wikihow.com/crear-un-script-de-inicio-de-sesi%C3%B3n-segura-en-php-y-MySQL">Cómo crear un script de inicio de sesión segura en php y MySQL</a><span>,&nbsp;Italiano:&nbsp;<span><a href="http://it.wikihow.com/Creare-uno-Script-Sicuro-per-il-Login-Usando-PHP-e-MySQL">Come Creare uno Script Sicuro per il Login Usando PHP e MySQL</a><span>,&nbsp;Deutsch:&nbsp;<span><a href="http://de.wikihow.com/Ein-sicheres-Login-Skript-mit-PHP-und-MySQL-erstellen">Ein sicheres Login Skript mit PHP und MySQL erstellen</a><span>,&nbsp;Français:&nbsp;<span><a href="http://fr.wikihow.com/cr%C3%A9er-un-script-de-connexion-s%C3%A9curis%C3%A9e-avec-PHP-et-MySQL">Comment créer un script de connexion sécurisée avec PHP et MySQL</a><span>,&nbsp;Русский:&nbsp;<span><a href="http://ru.wikihow.com/%D1%81%D0%BE%D0%B7%D0%B4%D0%B0%D1%82%D1%8C-%D0%B1%D0%B5%D0%B7%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D1%8B%D0%B9-%D0%BB%D0%BE%D0%B3%D0%B8%D0%BD-%D1%81%D0%BA%D1%80%D0%B8%D0%BF%D1%82-%D0%B2-PHP-%D0%B8-MySQL">создать безопасный логин скрипт в PHP и MySQL</a><span>							</span></span></span></span></span></span></span></span></span></span></span></span></p>
												<ul id="end_options">
							<li class="endop_discuss"><span></span><a href="http://www.wikihow.com/Discussion:Create-a-Secure-Login-Script-in-PHP-and-MySQL" id="gatDiscussionFooter">Discuss</a></li>
							<li class="endop_print"><span></span><a href="http://www.wikihow.com/index.php?title=Create-a-Secure-Login-Script-in-PHP-and-MySQL&amp;printable=yes" id="gatPrintView">Print</a></li>
							<li class="endop_email"><span></span><a href="#" onclick="return emailLink();" id="gatSharingEmail">Email</a></li>
														<li class="endop_edit"><span></span><a href="http://www.wikihow.com/index.php?title=Create-a-Secure-Login-Script-in-PHP-and-MySQL&amp;action=edit" id="gatEditFooter">Edit</a></li>
															<li class="endop_fanmail"><span></span><a href="http://www.wikihow.com/Special:ThankAuthors?target=Create-a-Secure-Login-Script-in-PHP-and-MySQL" id="gatThankAuthors">Send fan mail to authors</a></li>
													</ul> <!--end end_options -->
							
														<div class="ad_label ad_label7">Ad</div>
<div class="wh_ad_inner adunit7">
<script type="text/javascript">
<!--
<!-- MediaWiki:Adunit7 -->
	
google_ad_client = "ca-pub-9543332082073187";
/* iFrame Unit - bottom of page */
//a or normal
google_ad_slot = '4009863375';


google_ad_width = 588;    
google_ad_height = 120;
google_ad_output = 'html';
google_override_format = true;
google_ad_channel = "8714426702+7733764704+1640266093+5860073694+6754085577+7974857016+6876289738+7122150828" + gchans + xchannels;
google_max_num_ads = 2;
google_ad_region = "test";

document.write('<sc' + 'ript t' + 'ype="text/javascript" s' + 'rc="http://pagead2.googlesyndication.com/pagead/show_ads.js"></' + 'script>');

//-->
</script><script type="text/javascript" src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/show_ads.js"></script><ins style="display:inline-table;border:none;height:120px;margin:0;padding:0;position:relative;visibility:visible;width:588px;background-color:transparent"><ins id="aswift_3_anchor" style="display:block;border:none;height:120px;margin:0;padding:0;position:relative;visibility:visible;width:588px;background-color:transparent"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_3" name="aswift_3" style="left:0;position:absolute;top:0;" frameborder="0" height="120" scrolling="no" width="588"></iframe></ins></ins>
</div>
<div class="clearall adclear"></div>                        <div class="clearall"></div>
					</div><!--end article_info section_text-->
						<p class="page_stats">Thanks to all authors for creating a page that has been read 597,565 times.</p>

						<div id="article_rating">
							<p>Was this article accurate?</p><span><a href='javascript:rateItem(1,%20642666,%20"article");' id="gatAccuracyYes" class="button secondary">Yes</a><a href='javascript:rateItem(0,%20642666,%20"article");' id="gatAccuracyNo" class="button secondary">No</a></span>						</div>
				</div><!--end section-->

			
		</div> <!-- article -->
		<div id="">

					</div>  <!--end last_question-->
		<div class="clearall"></div>

		</div>  <!--end article_shell-->


					<div id="sidebar">		
				
				<!-- Sidebar Top Widgets -->
								<!-- END Sidebar Top Widgets -->

								<div id="top_links" class="sidebox logged_out">
					<a href="http://www.wikihow.com/Special:Randomizer" id="gatRandom" accesskey="x" class="button secondary">Random Article</a>
					<a href="http://www.wikihow.com/Special:Createpage" id="gatWriteAnArticle" class="button secondary">Write An Article</a>
									</div><!--end top_links-->
								
				

									<script>
						<!--
						var aax_src='3003';
						var amzn_targs = '';
						var url = encodeURIComponent(document.location);
						try { url = encodeURIComponent("" + window.top.location); } catch(e) {}
						document.write("<scr"+"ipt src='//aax-us-east.amazon-Adsystem.com/e/dtb/bid?src=" + aax_src + "&u="+url+"&cb=" + Math.round(Math.random()*10000000) + "'></scr"+"ipt>");
						document.close();
						//-->
					</script><script src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/bid.js"></script>
											<div class="wh_ad">
<div class="side_ad">
<script type="text/javascript"><!--
if(!gHideAds) {

var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
(function() {
var gads = document.createElement('script');
gads.async = true;
gads.type = 'text/javascript';
var useSSL = 'https:' == document.location.protocol;
gads.src = (useSSL ? 'https:' : 'http:') + '//www.googletagservices.com/tag/js/gpt.js';
var node = document.getElementsByTagName('script')[0];
node.parentNode.insertBefore(gads, node);
})();

googletag.cmd.push(function() {
googletag.defineSlot('/10095428/IMAGE_RR_COMP_ELECTRO', [300, 250], 'div-gpt-ad-1358462906741-2').addService(googletag.pubads());
googletag.pubads().enableSingleRequest();
googletag.enableServices();
});

// added for amazon targeting ad test
if(typeof document.amzn_slots != 'undefined') {
googletag.cmd.push(function() {
try {
for(var slot in document.amzn_slots) {
var slot_name = document.amzn_slots[slot];
googletag.pubads().setTargeting(slot_name, "1");
} 
} catch(e) {}
});
}

document.write("<div id='div-gpt-ad-1358462906741-2' style='width:300px; height:250px;'>");
googletag.cmd.push(function() { googletag.display('div-gpt-ad-1358462906741-2'); });
document.write("</div>");

}
//-->
</script><div id="div-gpt-ad-1358462906741-2" style="width: 300px; height: 250px;"><div style="border: 0pt none;" id="google_ads_iframe_/10095428/IMAGE_RR_COMP_ELECTRO_0__container__"><iframe src="javascript:&quot;<html><body style='background:transparent'></body></html>&quot;" style="border: 0px none; vertical-align: bottom;" marginheight="0" marginwidth="0" name="google_ads_iframe_/10095428/IMAGE_RR_COMP_ELECTRO_0" id="google_ads_iframe_/10095428/IMAGE_RR_COMP_ELECTRO_0" frameborder="0" height="250" scrolling="no" width="300"></iframe></div><iframe src="javascript:&quot;<html><body style='background:transparent'></body></html>&quot;" style="border: 0px none; vertical-align: bottom; visibility: hidden; display: none;" marginheight="0" marginwidth="0" name="google_ads_iframe_/10095428/IMAGE_RR_COMP_ELECTRO_0__hidden__" id="google_ads_iframe_/10095428/IMAGE_RR_COMP_ELECTRO_0__hidden__" frameborder="0" height="0" scrolling="no" width="0"></iframe></div>
</div>
</div>
								
				<div id="side_related_articles" class="sidebox"><h3>Related Articles</h3><div class="thumbnail" style="width:127px; height:140px;"><a href="http://www.wikihow.com/Make-a-Simple-Animated-Banner-in-Flash-CS3"><img src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/-crop-127-140-127px-Make-a-Simple-Animated-Banner-in-Flash-C.jpg" alt=""><div class="text"><p>How to <br><span>Make a Simple Animated Banner in Flash CS3</span></p></div></a></div><div class="thumbnail" style="width:127px; height:140px;"><a href="http://www.wikihow.com/Geocode-an-Address-in-Google-Maps-Javascript"><img src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/-crop-127-140-127px-Geocode-an-Address-in-Google-Maps-Javasc.jpg" alt=""><div class="text"><p>How to <br><span>Geocode an Address in Google Maps Javascript</span></p></div></a></div><div class="thumbnail" style="width:127px; height:140px;"><a href="http://www.wikihow.com/Write-Secure-Software-for-the-Web"><img src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/-crop-127-140-127px-Pbs_robots.png" alt=""><div class="text"><p>How to <br><span>Write Secure Software for the Web</span></p></div></a></div><div class="thumbnail" style="width:127px; height:140px;"><a href="http://www.wikihow.com/Program-in-Ajax"><img src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/-crop-127-140-127px-FinalResult.png" alt=""><div class="text"><p>How to <br><span>Program in Ajax</span></p></div></a></div><div class="clearall"></div>
</div><!--end side_related_articles-->
									<div class="sidebox logged_out" id="sidebar_share">
						<h3>Share</h3>
						<div class="gplus1_button"><div id="___plusone_0" style="text-indent: 0px; margin: 0px; padding: 0px; background: none repeat scroll 0% 0% transparent; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; display: inline-block; width: 50px; height: 60px;"><iframe title="+1" data-gapiattached="true" src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/fastbutton.html" name="I0_1398286723147" id="I0_1398286723147" vspace="0" tabindex="0" style="position: static; top: 0px; width: 50px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 60px;" marginwidth="0" marginheight="0" hspace="0" frameborder="0" scrolling="no" width="100%"></iframe></div></div><div class="like_button"><fb:like fb-iframe-plugin-query="app_id=157545333433&amp;href=http%3A%2F%2Fwww.wikihow.com%2FCreate-a-Secure-Login-Script-in-PHP-and-MySQL&amp;layout=box_count&amp;locale=en_US&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=46" fb-xfbml-state="parsed" class=" fb_iframe_widget" href="http://www.wikihow.com/Create-a-Secure-Login-Script-in-PHP-and-MySQL" send="false" layout="box_count" width="46" show_faces="false"><span style="vertical-align: top; width: 0px; height: 0px;"><iframe src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/like.html" style="border: medium none; visibility: hidden;" title="fb:like Facebook Social Plugin" allowtransparency="true" name="f6776cc7d46268" frameborder="0" height="1000px" scrolling="no" width="46px"></iframe></span></fb:like></div><div id="pinterest"><a data-pin-config="above" data-pin-log="button_pinit" target="_blank" class="PIN_1398286719774_pin_it_button_20 PIN_1398286719774_pin_it_button_en_20_gray PIN_1398286719774_pin_it_button_inline_20 PIN_1398286719774_pin_it_above_20" href="http://www.pinterest.com/pin/create/button/?url=http%3A%2F%2Fwww.wikihow.com%2FCreate-a-Secure-Login-Script-in-PHP-and-MySQL&amp;media=http%3A%2F%2Fpad3.whstatic.com%2Fimages%2Fd%2Fdc%2FCategory_computers.jpg&amp;guid=3ZrZzJFQjPrD-0&amp;description=How+to+Create+a+Secure+Login+Script+in+PHP+and+MySQL+--+via+wikiHow.com"><span id="PIN_1398286719774_pin_count_0" class="PIN_1398286719774_pin_it_button_count"><i></i>12</span></a></div><div class="admin_state"><iframe style="width: 55px; height: 62px;" data-twttr-rendered="true" title="Twitter Tweet Button" class="twitter-share-button twitter-tweet-button twitter-count-vertical" src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/tweet_button.html" allowtransparency="true" id="twitter-widget-0" frameborder="0" scrolling="no"></iframe></div>						<div style="clear:both; float:none;"></div>
					</div>
				
									

						
				
				<!-- Sidebar Widgets -->
								<!-- END Sidebar Widgets -->

				

									<div id="side_featured_articles" class="sidebox">
						<h3><span onclick="location='/Category:Featured-Articles';" style="cursor:pointer;">Featured Articles</span></h3>
<div class="thumbnail" style="width:126px; height:120px;"><a href="http://www.wikihow.com/Collect-Things"><img src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/-crop-126-120-126px-Collect-Things-Step-13.jpg" alt=""><div class="text"><p>How to <br><span>Collect Things</span></p></div></a></div><div class="thumbnail" style="width:126px; height:120px;"><a href="http://www.wikihow.com/Teach-Your-Child-Phonological-Awareness"><img src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/-crop-126-120-126px-Lettersoundmatch1.jpg" alt=""><div class="text"><p>How to <br><span>Teach Your Child Phonological Awareness</span></p></div></a></div><div class="thumbnail" style="width:126px; height:120px;"><a href="http://www.wikihow.com/Flat-Iron-Hair"><img src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/-crop-126-120-126px-Flat-Iron-Hair-Step-14.jpg" alt=""><div class="text"><p>How to <br><span>Flat Iron Hair</span></p></div></a></div><div class="thumbnail" style="width:126px; height:120px;"><a href="http://www.wikihow.com/Use-Google-Keep"><img src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/-crop-126-120-76px-Enter-notes.PNG" alt=""><div class="text"><p>How to <br><span>Use Google Keep</span></p></div></a></div><div class="clearall"></div>					</div>
				
				
									<div id="side_featured_contributor" class="sidebox">
							<div>
		<h3>Meet a Community Member</h3>
		<div class="featuredContrib_id">
					<span id="fc_id_img" class="fc_id_img"><a href="http://www.wikihow.com/User:Shinako" onclick='gatTrack("Browsing","Feat_contrib_img","Feat_contrib_wgt");'><img src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/1954607.jpg"></a></span>
				<span id="fc_id" class="fc_id" onclick='gatTrack("Browsing","Feat_contrib_blurb","Feat_contrib_wgt");'><p>Meet <a href="http://www.wikihow.com/User:Shinako" title="User:Shinako">Shinako</a>,
 a community member from India who has been on the site over a year. She
 holds several roles in the community, including being a <a href="http://www.wikihow.com/Become-a-New-Article-Booster-on-wikiHow" title="Become a New Article Booster on wikiHow">New Article Booster</a>, <a href="http://www.wikihow.com/Become-a-wikiHow-Admin" title="Become a wikiHow Admin">Admin</a>, and <a href="http://www.wikihow.com/Become-a-Welcome-Wagon-User-on-wikiHow" title="Become a Welcome Wagon User on wikiHow">Welcomer</a>, and she has started 11 articles and patrolled over 10,000 edits. She loves <a href="http://www.wikihow.com/Special:RCPatrol" title="Special:RCPatrol">patrolling recent changes</a>, <a href="http://www.wikihow.com/Special:NFDGuardian" title="Special:NFDGuardian">voting in the NFD Guardian</a>,
 and helping to spread friendliness and helpfulness in the community, 
which is evident in the help she provides to others around the site, 
particularly <a href="http://www.wikihow.com/Special:Newcontributors" title="Special:Newcontributors">new users</a>. The first article she ever worked on here was <a href="http://www.wikihow.com/Write-Alliteration-Poems" title="Write Alliteration Poems">How to Write Alliteration Poems</a>, which went from being nominated for deletion to a <a href="http://www.wikihow.com/Write-a-Featured-Article-on-wikiHow" title="Write a Featured Article on wikiHow">Featured Article</a>,
 thanks to collaborative editing. She’s proud of being able to share 
knowledge with people all around the world, and she sees the wikiHow 
community like a loving family. Her advice to new contributors is, 
“Don’t be afraid to <a href="http://www.wikihow.com/wikiHow_talk:Help-Team" title="wikiHow_talk:Help Team">ask questions</a>!”</p></span>
		</div>
        <div class="clearall"></div>
	</div>

													<p class="bottom_button">
								<a href="http://www.wikihow.com/Special:Userlogin" class="button secondary" id="gatFCWidgetBottom" onclick='gatTrack("Browsing","Feat_contrib_cta","Feat_contrib_wgt");'>Join The Community</a>
							</p>
											</div><!--end side_featured_contributor-->
				
				
													<div class="sidebox">
							<h3>Follow Us On...</h3>
	<table id="follow_table" cellpadding="0" cellspacing="0">
        <tbody><tr>
            <td><a href="http://www.facebook.com/wikiHow" target="_blank" id="gatFollowFacebook"><div class="follow-facebook"></div></a></td>
            <td><a href="https://www.twitter.com/wikihow" target="_blank" id="gatFollowTwitter"><div class="follow-twitter"></div></a></td>
            <td><a href="http://www.wikihow.com/feed.rss" target="_blank" id="gatFollowRss"><div class="follow-feed"></div></a></td>
            <td><a href="#" onclick="return false;" id="ccsfg_btn"><div class="follow-email"></div></a></td> 
            <td><a href="https://plus.google.com/u/0/b/102818024478962731382/" target="_blank" id="gatFollowPlus"><div class="follow-plus"></div></a></td>
        </tr>
        <tr>
            <td><a href="http://pinterest.com/wikihow/" target="_blank" id="gatFollowPinterest"><div class="follow-pinterest"></div></a></td>
            <td><a href="http://wikihow.tumblr.com/" target="_blank" id="gatFollowTumblr"><div class="follow-tumblr"></div></a></td>
            <td><a href="http://www.stumbleupon.com/channel/wikiHow" target="_blank" id="gatFollowStumbleupon"><div class="follow-stumbleupon"></div></a></td> 
            <td><a href="https://market.android.com/details?id=com.wikihow.wikihowapp" target="_blank" id="gatFollowAndroid"><div class="follow-android"></div></a></td>
            <td><a href="http://itunes.apple.com/us/app/wikihow-how-to-diy-survival/id309209200?mt=8" target="_blank" id="gatFollowApp"><div class="follow-iphone"></div></a></td>
        </tr>
</tbody></table>
					</div>
							</div><!--end sidebar-->
				<div class="clearall"></div>
		</div> <!--end container -->
		</div><!--end main-->
			<div id="clear_footer"></div>
		</div><!--end main_container-->
		<div id="footer_outer">
			<div id="footer">
				<div id="footer_side">
											<ul>
<li class="top"><a href="http://www.wikihow.com/Main-Page" title="Main Page">Home</a></li>
<li><a href="http://www.wikihow.com/About-wikiHow" title="About wikiHow" class="mw-redirect">About wikiHow</a></li>
<li><a href="http://www.wikihow.com/Terms-of-Use" title="Terms of Use" class="mw-redirect">Terms of Use</a></li>
<li><a rel="nofollow" class="external text" href="http://www.wikihow.com/feed.rss">RSS</a></li>
<li><a href="http://www.wikihow.com/Special:Sitemap" title="Special:Sitemap">Site map</a></li>
<li><a href="http://www.wikihow.com/Special:UserLogin" title="Special:UserLogin">Log In</a></li>
</ul>
									</div><!--end footer_side-->

				<div id="footer_main">

					<div id="sub_footer">
													<!-- MediaWiki:Sub_footer_new_anon -->
<div id="creative_commons">
    <a href="http://www.wikihow.com/wikiHow:Creative-Commons" class="imglink sub_footer_link footer_creative_commons footer_sprite"></a>
    All text shared under a <a href="http://www.wikihow.com/wikiHow:Creative-Commons">Creative Commons License</a>.
</div>

<div id="mediawiki_p">
    <a href="http://www.wikihow.com/Powered-and-Inspired-by-Mediawiki" class="imglink sub_footer_link footer_mediawiki footer_sprite"></a>
    <a href="http://www.wikihow.com/Powered-and-Inspired-by-Mediawiki">Powered by Mediawiki.</a>
</div>											</div>
				</div><!--end footer_main-->
			</div>
				<br class="clearall">
		</div><!--end footer-->
		<div id="dialog-box" title=""></div>

		<div id="sliderbox" class="sliderbox_08">
						<div id="slider_thanks_08">
							<a href="#" id="slider_close_button"></a>
							<div class="slider_become_main">
								<p class="slider_editing_text">Contribute<br>to wikiHow!</p>
								<!--p>Edit this article.</p-->
								<p class="slider_button"><a class="button primary" id="slider_edit_button" href="#">Edit this article</a></p>
							</div>
						</div>
					</div><div id="slideshowdetect"></div>
		<div class=" fb_reset" id="fb-root"><script async="" src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/all.js" type="text/javascript"></script><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/ping.html" style="display: none;" allowtransparency="true" name="f29a1d1fff227d6" frameborder="0" scrolling="no"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/dgdTycPTSRj.html" style="border: medium none;" tab-index="-1" title="Facebook Cross Domain Communication Frame" aria-hidden="true" id="fb_xdm_frame_http" allowtransparency="true" name="fb_xdm_frame_http" frameborder="0" scrolling="no"></iframe><iframe src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/dgdTycPTSRj_002.html" style="border: medium none;" tab-index="-1" title="Facebook Cross Domain Communication Frame" aria-hidden="true" id="fb_xdm_frame_https" allowtransparency="true" name="fb_xdm_frame_https" frameborder="0" scrolling="no"></iframe></div></div></div>

					<script>/*<![CDATA[*/var mediaWikiLoadStart=(new Date()).getTime();function isCompatible(ua){if(ua===undefined){ua=navigator.userAgent;}return!((ua.indexOf('MSIE')!==-1&&parseFloat(ua.split('MSIE')[1])<6)||(ua.indexOf('Firefox/')!==-1&&parseFloat(ua.split('Firefox/')[1])<3)||ua.match(/BlackBerry[^\/]*\/[1-5]\./)||ua.match(/webOS\/1\.[0-4]/)||ua.match(/PlayStation/i)||ua.match(/SymbianOS|Series60/)||ua.match(/NetFront/)||ua.match(/Opera Mini/)||ua.match(/S40OviBrowser/)||(ua.match(/Glass/)&&ua.match(/Android/)));}var startUp=function(){mw.config=new mw.Map(true);mw.loader.addSource({"local":{"loadScript":"/load.php","apiScript":"/api.php"}});mw.loader.register([["site","1398118326",[],"site"],["noscript","1398118326",[],"noscript"],["startup","1398223651",[],"startup"],["filepage","1398118326"],["user.groups","1398118326",[],"user"],["user","1398118326",[],"user"],["user.cssprefs","1398118326",["mediawiki.user"],"private"],["user.options","1398118326",[],"private"],["user.tokens","1398118326",[],"private"],
["mediawiki.language.data","1398118326",["mediawiki.language.init"]],["skins.common.elements","1398118326"],["skins.common.content","1398118326"],["skins.common.interface","1398118326"],["skins.cologneblue","1398118326"],["skins.modern","1398118326"],["skins.vector.styles","1398118326"],["skins.monobook.styles","1398118326"],["skins.vector.js","1398118326",["jquery.delayedBind"]],["skins.vector.collapsibleNav","1398118326",["jquery.client","jquery.cookie","jquery.tabIndex"]],["jquery","1398118326"],["jquery.appear","1398118326"],["jquery.arrowSteps","1398118326"],["jquery.async","1398118326"],["jquery.autoEllipsis","1398118326",["jquery.highlightText"]],["jquery.badge","1398118326",["mediawiki.language"]],["jquery.byteLength","1398118326"],["jquery.byteLimit","1398118326",["jquery.byteLength"]],["jquery.checkboxShiftClick","1398118326"],["jquery.chosen","1398118326"],["jquery.client","1398118326"],["jquery.color","1398118326",["jquery.colorUtil"]],["jquery.colorUtil","1398118326"],[
"jquery.cookie","1398118326"],["jquery.delayedBind","1398118326"],["jquery.expandableField","1398118326",["jquery.delayedBind"]],["jquery.farbtastic","1398118326",["jquery.colorUtil"]],["jquery.footHovzer","1398118326"],["jquery.form","1398118326"],["jquery.fullscreen","1398118326"],["jquery.getAttrs","1398118326"],["jquery.hidpi","1398118326"],["jquery.highlightText","1398118326",["jquery.mwExtension"]],["jquery.hoverIntent","1398118326"],["jquery.json","1398118326"],["jquery.localize","1398118326"],["jquery.makeCollapsible","1398223585"],["jquery.mockjax","1398118326"],["jquery.mw-jump","1398118326"],["jquery.mwExtension","1398118326"],["jquery.placeholder","1398118326"],["jquery.qunit","1398118326"],["jquery.qunit.completenessTest","1398118326",["jquery.qunit"]],["jquery.spinner","1398118326"],["jquery.jStorage","1398118326",["jquery.json"]],["jquery.suggestions","1398118326",["jquery.autoEllipsis"]],["jquery.tabIndex","1398118326"],["jquery.tablesorter","1398118326",[
"jquery.mwExtension","mediawiki.language.months"]],["jquery.textSelection","1398118326",["jquery.client"]],["jquery.throttle-debounce","1398118326"],["jquery.validate","1398118326"],["jquery.xmldom","1398118326"],["jquery.tipsy","1398118326"],["jquery.ui.core","1398118326",["jquery"],"jquery.ui"],["jquery.ui.widget","1398118326",[],"jquery.ui"],["jquery.ui.mouse","1398118326",["jquery.ui.widget"],"jquery.ui"],["jquery.ui.position","1398118326",[],"jquery.ui"],["jquery.ui.draggable","1398118326",["jquery.ui.core","jquery.ui.mouse","jquery.ui.widget"],"jquery.ui"],["jquery.ui.droppable","1398118326",["jquery.ui.core","jquery.ui.draggable","jquery.ui.mouse","jquery.ui.widget"],"jquery.ui"],["jquery.ui.resizable","1398118326",["jquery.ui.core","jquery.ui.mouse","jquery.ui.widget"],"jquery.ui"],["jquery.ui.selectable","1398118326",["jquery.ui.core","jquery.ui.mouse","jquery.ui.widget"],"jquery.ui"],["jquery.ui.sortable","1398118326",["jquery.ui.core","jquery.ui.mouse","jquery.ui.widget"],
"jquery.ui"],["jquery.ui.accordion","1398118326",["jquery.ui.core","jquery.ui.widget"],"jquery.ui"],["jquery.ui.autocomplete","1398118326",["jquery.ui.core","jquery.ui.position","jquery.ui.widget"],"jquery.ui"],["jquery.ui.button","1398118326",["jquery.ui.core","jquery.ui.widget"],"jquery.ui"],["jquery.ui.datepicker","1398118326",["jquery.ui.core"],"jquery.ui"],["jquery.ui.dialog","1398118326",["jquery.ui.button","jquery.ui.core","jquery.ui.draggable","jquery.ui.mouse","jquery.ui.position","jquery.ui.resizable","jquery.ui.widget"],"jquery.ui"],["jquery.ui.progressbar","1398118326",["jquery.ui.core","jquery.ui.widget"],"jquery.ui"],["jquery.ui.slider","1398118326",["jquery.ui.core","jquery.ui.mouse","jquery.ui.widget"],"jquery.ui"],["jquery.ui.tabs","1398118326",["jquery.ui.core","jquery.ui.widget"],"jquery.ui"],["jquery.effects.core","1398118326",["jquery"],"jquery.ui"],["jquery.effects.blind","1398118326",["jquery.effects.core"],"jquery.ui"],["jquery.effects.bounce","1398118326",[
"jquery.effects.core"],"jquery.ui"],["jquery.effects.clip","1398118326",["jquery.effects.core"],"jquery.ui"],["jquery.effects.drop","1398118326",["jquery.effects.core"],"jquery.ui"],["jquery.effects.explode","1398118326",["jquery.effects.core"],"jquery.ui"],["jquery.effects.fade","1398118326",["jquery.effects.core"],"jquery.ui"],["jquery.effects.fold","1398118326",["jquery.effects.core"],"jquery.ui"],["jquery.effects.highlight","1398118326",["jquery.effects.core"],"jquery.ui"],["jquery.effects.pulsate","1398118326",["jquery.effects.core"],"jquery.ui"],["jquery.effects.scale","1398118326",["jquery.effects.core"],"jquery.ui"],["jquery.effects.shake","1398118326",["jquery.effects.core"],"jquery.ui"],["jquery.effects.slide","1398118326",["jquery.effects.core"],"jquery.ui"],["jquery.effects.transfer","1398118326",["jquery.effects.core"],"jquery.ui"],["moment","1398118326"],["mediawiki","1398118326"],["mediawiki.api","1398118326",["mediawiki.util"]],["mediawiki.api.category","1398118326",[
"mediawiki.Title","mediawiki.api"]],["mediawiki.api.edit","1398118326",["mediawiki.Title","mediawiki.api"]],["mediawiki.api.login","1398118326",["mediawiki.api"]],["mediawiki.api.parse","1398118326",["mediawiki.api"]],["mediawiki.api.watch","1398118326",["mediawiki.api","user.tokens"]],["mediawiki.debug","1398118326",["jquery.footHovzer"]],["mediawiki.debug.init","1398118326",["mediawiki.debug"]],["mediawiki.feedback","1398118326",["jquery.ui.dialog","mediawiki.Title","mediawiki.api.edit","mediawiki.jqueryMsg"]],["mediawiki.hidpi","1398118326",["jquery.hidpi"]],["mediawiki.hlist","1398118326",["jquery.client"]],["mediawiki.htmlform","1398118326"],["mediawiki.icon","1398118326"],["mediawiki.inspect","1398118326",["jquery.byteLength","jquery.json"]],["mediawiki.notification","1398118326",["mediawiki.page.startup"]],["mediawiki.notify","1398118326"],["mediawiki.searchSuggest","1398223585",["jquery.autoEllipsis","jquery.client","jquery.placeholder","jquery.suggestions","mediawiki.api"]],[
"mediawiki.Title","1398118326",["jquery.byteLength","mediawiki.util"]],["mediawiki.toc","1398223651",["jquery.cookie"]],["mediawiki.Uri","1398118326"],["mediawiki.user","1398118326",["jquery.cookie","mediawiki.api","user.options","user.tokens"]],["mediawiki.util","1398118326",["jquery.client","jquery.mwExtension","mediawiki.notify","mediawiki.toc"]],["mediawiki.action.edit","1398118326",["jquery.byteLimit","jquery.textSelection","mediawiki.action.edit.styles"]],["mediawiki.action.edit.styles","1398118326"],["mediawiki.action.edit.collapsibleFooter","1398118326",["jquery.cookie","jquery.makeCollapsible","mediawiki.icon"]],["mediawiki.action.edit.preview","1398118326",["jquery.form","jquery.spinner","mediawiki.action.history.diff"]],["mediawiki.action.history","1398118326",[],"mediawiki.action.history"],["mediawiki.action.history.diff","1398118326",[],"mediawiki.action.history"],["mediawiki.action.view.dblClickEdit","1398118326",["mediawiki.page.startup","mediawiki.util"]],[
"mediawiki.action.view.metadata","1398118326"],["mediawiki.action.view.postEdit","1398223628",["jquery.cookie","mediawiki.jqueryMsg"]],["mediawiki.action.view.redirectToFragment","1398118326",["jquery.client"]],["mediawiki.action.view.rightClickEdit","1398118326"],["mediawiki.action.edit.editWarning","1398223585",["mediawiki.jqueryMsg"]],["mediawiki.action.watch.ajax","1398118326",["mediawiki.page.watch.ajax"]],["mediawiki.language","1398118326",["mediawiki.cldr","mediawiki.language.data"]],["mediawiki.cldr","1398118326",["mediawiki.libs.pluralruleparser"]],["mediawiki.libs.pluralruleparser","1398118326"],["mediawiki.language.init","1398118326"],["mediawiki.jqueryMsg","1398118326",["mediawiki.language","mediawiki.util"]],["mediawiki.language.months","1398118326",["mediawiki.language"]],["mediawiki.libs.jpegmeta","1398118326"],["mediawiki.page.gallery","1398118326"],["mediawiki.page.ready","1398118326",["jquery.checkboxShiftClick","jquery.makeCollapsible","jquery.mw-jump",
"jquery.placeholder","mediawiki.util"]],["mediawiki.page.startup","1398118326",["jquery.client","mediawiki.util"]],["mediawiki.page.patrol.ajax","1398118326",["jquery.spinner","mediawiki.Title","mediawiki.api","mediawiki.notify","mediawiki.page.startup","mediawiki.util","user.tokens"]],["mediawiki.page.watch.ajax","1398223585",["jquery.mwExtension","mediawiki.api.watch","mediawiki.notify","mediawiki.page.startup","mediawiki.util"]],["mediawiki.page.image.pagination","1398118326",["jquery.spinner"]],["mediawiki.special","1398118326"],["mediawiki.special.block","1398118326",["mediawiki.util"]],["mediawiki.special.changeemail","1398118326",["mediawiki.util"]],["mediawiki.special.changeslist","1398118326"],["mediawiki.special.changeslist.legend","1398118326"],["mediawiki.special.changeslist.legend.js","1398118326",["jquery.cookie","jquery.makeCollapsible"]],["mediawiki.special.changeslist.enhanced","1398118326"],["mediawiki.special.movePage","1398118326",["jquery.byteLimit"]],[
"mediawiki.special.pagesWithProp","1398118326"],["mediawiki.special.preferences","1398118326",["mediawiki.language"]],["mediawiki.special.recentchanges","1398118326",["mediawiki.special"]],["mediawiki.special.search","1398118326"],["mediawiki.special.undelete","1398118326"],["mediawiki.special.upload","1398118326",["mediawiki.libs.jpegmeta","mediawiki.util"]],["mediawiki.special.userlogin.common.styles","1398118326"],["mediawiki.special.userlogin.signup.styles","1398118326"],["mediawiki.special.userlogin.login.styles","1398118326"],["mediawiki.special.userlogin.common.js","1398223600"],["mediawiki.special.userlogin.signup.js","1398223602",["mediawiki.jqueryMsg"]],["mediawiki.special.javaScriptTest","1398118326",["jquery.qunit"]],["mediawiki.special.version","1398118326"],["mediawiki.legacy.ajax","1398118326",["mediawiki.legacy.wikibits","mediawiki.util"]],["mediawiki.legacy.commonPrint","1398118326"],["mediawiki.legacy.config","1398118326",["mediawiki.legacy.wikibits"]],[
"mediawiki.legacy.protect","1398118326",["jquery.byteLimit"]],["mediawiki.legacy.shared","1398118326"],["mediawiki.legacy.oldshared","1398118326"],["mediawiki.legacy.upload","1398118326",["jquery.spinner","mediawiki.Title","mediawiki.api","mediawiki.util"]],["mediawiki.legacy.wikibits","1398118326",["mediawiki.util"]],["mediawiki.ui","1398118326"],["mediawiki.ui.button","1398118326"],["oojs","1398118326"],["oojs-ui","1398118326",["oojs"]],["ext.eventLogging","1398118326",["jquery.json","mediawiki.util"]],["ext.eventLogging.jsonSchema","1398118326"],["schema.GuidedTour","1398118326",["ext.eventLogging"]],["mediawiki.libs.guiders","1398118326"],["ext.guidedTour.styles","1398118326",["mediawiki.libs.guiders","mediawiki.ui.button"]],["ext.guidedTour.siteStyles","1398118326",["ext.guidedTour.styles"]],["ext.guidedTour.lib.internal","1398118326"],["ext.guidedTour.lib","1398223585",["ext.guidedTour.lib.internal","ext.guidedTour.siteStyles","jquery.cookie","jquery.json","mediawiki.jqueryMsg",
"mediawiki.libs.guiders","mediawiki.util","schema.GuidedTour"]],["ext.guidedTour","1398118326",["ext.guidedTour.lib"]],["ext.guidedTour.tour.dashboard","1398223585",["ext.guidedTour"]],["ext.guidedTour.tour.fe","1398118326",["ext.guidedTour"]],["ext.guidedTour.tour.rc","1398223628",["ext.guidedTour"]],["ext.guidedTour.tour.talk","1398223585",["ext.guidedTour"]],["ext.guidedTour.tour.firstedit","1398118326",["ext.guidedTour"]],["ext.guidedTour.tour.firsteditve","1398118326",["ext.guidedTour"]],["ext.guidedTour.tour.test","1398118326",["ext.guidedTour"]],["ext.checkUser","1398118326",["mediawiki.util"]],["ext.cite","1398118326",["jquery.tooltip"]],["jquery.tooltip","1398118326"],["ext.rtlcite","1398118326"],["ext.Drafts","1398223585",["mediawiki.jqueryMsg","mediawiki.legacy.wikibits"]],["ext.confirmEdit.fancyCaptcha.styles","1398118326"],["ext.confirmEdit.fancyCaptcha","1398118326",["mediawiki.api"]],["ext.confirmEdit.fancyCaptchaMobile","1398118326",["mobile.startup"]],[
"ext.geshi.local","1398118326"],["ext.MassMessage.special.js","1398118326",["jquery.byteLimit","jquery.delayedBind","jquery.ui.autocomplete","mediawiki.jqueryMsg"]],["ext.MassMessage.special","1398118326"]]);mw.config.set({"wgLoadScript":"/load.php","debug":false,"skin":"wikihowskin","stylepath":"/skins","wgUrlProtocols":"http\\:\\/\\/|https\\:\\/\\/|ftp\\:\\/\\/|ftps\\:\\/\\/|ssh\\:\\/\\/|sftp\\:\\/\\/|irc\\:\\/\\/|ircs\\:\\/\\/|xmpp\\:|sip\\:|sips\\:|gopher\\:\\/\\/|telnet\\:\\/\\/|nntp\\:\\/\\/|worldwind\\:\\/\\/|mailto\\:|tel\\:|sms\\:|news\\:|svn\\:\\/\\/|git\\:\\/\\/|mms\\:\\/\\/|bitcoin\\:|magnet\\:|urn\\:|geo\\:|\\/\\/","wgArticlePath":"/$1","wgScriptPath":"","wgScriptExtension":".php","wgScript":"/index.php","wgVariantArticlePath":false,"wgActionPaths":{},"wgServer":"http://www.wikihow.com","wgUserLanguage":"en","wgContentLanguage":"en","wgVersion":"1.23wmf15","wgEnableAPI":true,"wgEnableWriteAPI":true,"wgMainPageTitle":"Main Page","wgFormattedNamespaces":{"-5":"Quiz","-4":
"Doc","-3":"Widget","-2":"Media","-1":"Special","0":"","1":"Discussion","2":"User","3":"User talk","4":"wikiHow","5":"wikiHow talk","6":"Image","7":"Image talk","8":"MediaWiki","9":"MediaWiki talk","10":"Template","11":"Template talk","12":"Help","13":"Help talk","14":"Category","15":"Category talk","16":"Request","17":"Request talk","18":"User kudos","19":"User kudos talk","24":"Video","25":"Video talk","26":"VideoComments","27":"VideoComments talk"},"wgNamespaceIds":{"quiz":-5,"doc":-4,"widget":-3,"media":-2,"special":-1,"":0,"discussion":1,"user":2,"user_talk":3,"wikihow":4,"wikihow_talk":5,"image":6,"image_talk":7,"mediawiki":8,"mediawiki_talk":9,"template":10,"template_talk":11,"help":12,"help_talk":13,"category":14,"category_talk":15,"request":16,"request_talk":17,"user_kudos":18,"user_kudos_talk":19,"video":24,"video_talk":25,"videocomments":26,"videocomments_talk":27,"talk":1,"project":4,"project_talk":5,"file":6,"file_talk":7},"wgContentNamespaces":[0],"wgSiteName":"wikiHow",
"wgFileExtensions":["png","gif","jpg","jpeg","pdf"],"wgDBname":"wikidb_112","wgFileCanRotate":true,"wgAvailableSkins":{"nostalgia":"Nostalgia","cologneblue":"CologneBlue","standard":"Standard","simple":"Simple","chick":"Chick","vector":"Vector","monobook":"MonoBook","modern":"Modern","myskin":"MySkin","wikihowskin":"WikiHowSkin"},"wgExtensionAssetsPath":"/extensions","wgCookiePrefix":"wiki_shared","wgCookieDomain":"wikihow.com","wgResourceLoaderMaxQueryLength":-1,"wgCaseSensitiveNamespaces":[],"wgLegalTitleChars":" %!\"$\u0026'()*,\\-./0-9:;=?@A-Z\\\\\\^_`a-z~+\\u0080-\\uFFFF","wgResourceLoaderStorageVersion":1,"wgResourceLoaderStorageEnabled":false,"wgEventLoggingBaseUri":false,"wgDraftAutoSaveWait":120,"wgDraftAutoSaveTimeout":20,"wgDraftAutoSaveInputBased":false});};if(isCompatible()){document.write(
"\u003Cscript src=\"/load.php?debug=false\u0026amp;lang=en\u0026amp;modules=jquery%2Cmediawiki\u0026amp;only=scripts\u0026amp;siterev=162e1f\u0026amp;skin=wikihowskin\"\u003E\u003C/script\u003E");}delete isCompatible;
/* cache key: wikidb_112:resourceloader:filter:minify-js:7:3aff3d4fc1de77e460f3eb2daaacc613 *//*]]>*/</script><script src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/load_003.js"></script><script>if(window.mw){
mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Create-a-Secure-Login-Script-in-PHP-and-MySQL","wgTitle":"Create a Secure Login Script in PHP and MySQL","wgCurRevisionId":13273805,"wgRevisionId":13273805,"wgArticleId":642666,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Web Programming"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Create-a-Secure-Login-Script-in-PHP-and-MySQL","wgIsProbablyEditable":true,"wgRestrictionEdit":[],"wgRestrictionMove":[],"wgGuidedTourHelpGuiderUrl":"Help:Guided tours/guider","wgWikihowSiteRev":"162e1f","wgFBAppId":"157545333433","wgCDNbase":"http://pad1.whstatic.com"});
}</script><script>if(window.mw){
mw.loader.implement("user.options",function(){mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"editfont":"default","editondblclick":0,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":1,"extendwatchlist":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"imagesize":2,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nickname":"","noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"rcdays":30,"rclimit":50,"rememberpassword":1,"rows":25,"showhiddencats":0,"shownumberswatching":1,"showtoolbar":1,"skin":"wikihowskin","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,
"watchmoves":0,"wllimit":250,"useeditwarning":1,"prefershttps":1,"show_google_authorship":0,"recent_changes_widget_show":1,"welcomer":0,"defaulteditor":"visual","disablesuggest":true,"scrolltalk":1,"rctest":0,"showtoc":0,"disablemarketingemail":0,"thumbsemailnotifications":0,"usertalknotifications":0,"enableauthoremail":0,"thumbsnotifications":0,"language":"en","variant-gan":"gan","variant-iu":"iu","variant-kk":"kk","variant-ku":"ku","variant-shi":"shi","variant-sr":"sr","variant-tg":"tg","variant-uz":"uz","variant-zh":"zh","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"searchNs16":false,"searchNs17":false,"searchNs18":false,"searchNs19":false,"searchNs24":false,"searchNs25":false,"searchNs26":false,"searchNs27":false,"extensionDrafts_enable":
true,"variant":"en"});},{},{});mw.loader.implement("user.tokens",function(){mw.user.tokens.set({"editToken":"+\\","patrolToken":false,"watchToken":false});},{},{});
/* cache key: wikidb_112:resourceloader:filter:minify-js:7:6c6c1d22d1ff44d6cb2dd73293e0ca7e */
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.page.startup","mediawiki.legacy.wikibits","mediawiki.legacy.ajax"]);
}</script><script src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/load_002.js"></script><style type="text/css">/*<![CDATA[*/
.source-sql {line-height: normal;}
.source-sql li, .source-sql pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for sql
 * CSS class: source-sql, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.sql.source-sql .de1, .sql.source-sql .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.sql.source-sql  {font-family:monospace;}
.sql.source-sql .imp {font-weight: bold; color: red;}
.sql.source-sql li, .sql.source-sql .li1 {font-weight: normal; vertical-align:top;}
.sql.source-sql .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.sql.source-sql .li2 {font-weight: bold; vertical-align:top;}
.sql.source-sql .kw1 {color: #993333; font-weight: bold;}
.sql.source-sql .co1 {color: #808080; font-style: italic;}
.sql.source-sql .coMULTI {color: #808080; font-style: italic;}
.sql.source-sql .es0 {color: #000099; font-weight: bold;}
.sql.source-sql .br0 {color: #66cc66;}
.sql.source-sql .sy0 {color: #66cc66;}
.sql.source-sql .st0 {color: #ff0000;}
.sql.source-sql .nu0 {color: #cc66cc;}
.sql.source-sql .ln-xtra, .sql.source-sql li.ln-xtra, .sql.source-sql div.ln-xtra {background-color: #ffc;}
.sql.source-sql span.xtra { display:block; }

/*]]>*/
</style><style type="text/css">/*<![CDATA[*/
.source-php {line-height: normal;}
.source-php li, .source-php pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for php
 * CSS class: source-php, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.php.source-php .de1, .php.source-php .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.php.source-php  {font-family:monospace;}
.php.source-php .imp {font-weight: bold; color: red;}
.php.source-php li, .php.source-php .li1 {font-weight: normal; vertical-align:top;}
.php.source-php .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.php.source-php .li2 {font-weight: bold; vertical-align:top;}
.php.source-php .kw1 {color: #b1b100;}
.php.source-php .kw2 {color: #000000; font-weight: bold;}
.php.source-php .kw3 {color: #990000;}
.php.source-php .kw4 {color: #009900; font-weight: bold;}
.php.source-php .co1 {color: #666666; font-style: italic;}
.php.source-php .co2 {color: #666666; font-style: italic;}
.php.source-php .co3 {color: #0000cc; font-style: italic;}
.php.source-php .co4 {color: #009933; font-style: italic;}
.php.source-php .coMULTI {color: #666666; font-style: italic;}
.php.source-php .es0 {color: #000099; font-weight: bold;}
.php.source-php .es1 {color: #000099; font-weight: bold;}
.php.source-php .es2 {color: #660099; font-weight: bold;}
.php.source-php .es3 {color: #660099; font-weight: bold;}
.php.source-php .es4 {color: #006699; font-weight: bold;}
.php.source-php .es5 {color: #006699; font-weight: bold; font-style: italic;}
.php.source-php .es6 {color: #009933; font-weight: bold;}
.php.source-php .es_h {color: #000099; font-weight: bold;}
.php.source-php .br0 {color: #009900;}
.php.source-php .sy0 {color: #339933;}
.php.source-php .sy1 {color: #000000; font-weight: bold;}
.php.source-php .st0 {color: #0000ff;}
.php.source-php .st_h {color: #0000ff;}
.php.source-php .nu0 {color: #cc66cc;}
.php.source-php .nu8 {color: #208080;}
.php.source-php .nu12 {color: #208080;}
.php.source-php .nu19 {color:#800080;}
.php.source-php .me1 {color: #004000;}
.php.source-php .me2 {color: #004000;}
.php.source-php .re0 {color: #000088;}
.php.source-php .ln-xtra, .php.source-php li.ln-xtra, .php.source-php div.ln-xtra {background-color: #ffc;}
.php.source-php span.xtra { display:block; }

/*]]>*/
</style><style type="text/css">/*<![CDATA[*/
.source-javascript {line-height: normal;}
.source-javascript li, .source-javascript pre {
	line-height: normal; border: 0px none white;
}
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for javascript
 * CSS class: source-javascript, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.javascript.source-javascript .de1, .javascript.source-javascript .de2 {font: normal normal 1em/1.2em monospace; margin:0; padding:0; background:none; vertical-align:top;font-family: monospace, monospace;}
.javascript.source-javascript  {font-family:monospace;}
.javascript.source-javascript .imp {font-weight: bold; color: red;}
.javascript.source-javascript li, .javascript.source-javascript .li1 {font-weight: normal; vertical-align:top;}
.javascript.source-javascript .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.javascript.source-javascript .li2 {font-weight: bold; vertical-align:top;}
.javascript.source-javascript .kw1 {color: #000066; font-weight: bold;}
.javascript.source-javascript .kw2 {color: #003366; font-weight: bold;}
.javascript.source-javascript .kw3 {color: #000066;}
.javascript.source-javascript .kw5 {color: #FF0000;}
.javascript.source-javascript .co1 {color: #006600; font-style: italic;}
.javascript.source-javascript .co2 {color: #009966; font-style: italic;}
.javascript.source-javascript .coMULTI {color: #006600; font-style: italic;}
.javascript.source-javascript .es0 {color: #000099; font-weight: bold;}
.javascript.source-javascript .br0 {color: #009900;}
.javascript.source-javascript .sy0 {color: #339933;}
.javascript.source-javascript .st0 {color: #3366CC;}
.javascript.source-javascript .nu0 {color: #CC0000;}
.javascript.source-javascript .me1 {color: #660066;}
.javascript.source-javascript .ln-xtra, .javascript.source-javascript li.ln-xtra, .javascript.source-javascript div.ln-xtra {background-color: #ffc;}
.javascript.source-javascript span.xtra { display:block; }

/*]]>*/
</style>			<script type="text/javascript" src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/whjsstuflsljthmaltjtptr162e1fe.js"></script>
				<script type="text/javascript">if(window['optimizely'] == undefined) { window['optimizely'] = [] } window['optimizely'].push(['addToSegment', 'wikihow_user_name', wgUserName]);</script><script src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/526710254.js"></script>
					<script>
				<!--
				if (WH.ExitTimer) {
					WH.ExitTimer.start();
				}
				//-->
			</script>
		
		
		<script type="text/javascript">
			<!--
			var _gaq = _gaq || [];
				_gaq.push(['_setAccount', 'UA-2375655-1']);
			_gaq.push(['_setDomainName', '.wikihow.com']);
			_gaq.push(['_trackPageview']);
			(function() {
				var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
				ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
			})();
				//-->
		</script>

					<script type="text/javascript">
			<!--
			if (typeof Event =='undefined' || typeof Event.observe == 'undefined') {
				jQuery(window).load(gatStartObservers);
			} else {
				Event.observe(window, 'load', gatStartObservers);
			}
			//-->
		</script>
									
				
					<script type="text/javascript">
			(function() {
				var ci = document.createElement('script'); ci.type = 'text/javascript'; ci.async = true;
				ci.src = 'http://cdn.clickigniter.io/ci.js';
				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ci, s);
			})();
			</script>
							<script type="text/javascript">
				var GoSquared = {};
				GoSquared.acct = "GSN-491441-Y";
				(function(w){
					function gs(){
						w._gstc_lt = +new Date;
						var d = document, g = d.createElement("script");
						g.type = "text/javascript";
						g.src = "//d1l6p2sc9645hc.cloudfront.net/tracker.js";
						g.async = true;
						var s = d.getElementsByTagName("script")[0];
						s.parentNode.insertBefore(g, s);
					}
					w.addEventListener ?
						w.addEventListener("load", gs, false) :
						w.attachEvent("onload", gs);
				})(window);
			</script>
								
					<script type="text/javascript">
	$(document).ready(function () {
		loadGoogleCSESearchBox('en');
	});
</script>		
<script type="text/javascript">
	(function ($) {
		$(document).ready(function() {
			WH.addScrollEffectToTOC();
		});

		$(window).load(function() {
			if ($('.twitter-share-button').length && (!$.browser.msie || $.browser.version > 7)) {

				$.getScript("https://platform.twitter.com/widgets.js", function() {
					twttr.events.bind('tweet', function(event) {
						if (event) {
							var targetUrl;
							if (event.target && event.target.nodeName == 'IFRAME') {
								targetUrl = extractParamFromUri(event.target.src, 'url');
							}
							_gaq.push(['_trackSocial', 'twitter', 'tweet', targetUrl]);
						}
					});

				});
			}

			if (isiPhone < 0 && isiPad < 0 && $('.gplus1_button').length) {
				WH.setGooglePlusOneLangCode();
				var node2 = document.createElement('script');
				node2.type = 'text/javascript';
				node2.async = true;
				node2.src = 'http://apis.google.com/js/plusone.js';
				$('body').append(node2);
			}
			if (typeof WH.FB != 'undefined') WH.FB.init('new');
			if (typeof WH.GP != 'undefined') WH.GP.init();

			if ($('#pinterest').length) {
				var node3 = document.createElement('script');
				node3.type = 'text/javascript';
				node3.async = true;
				node3.src = 'http://assets.pinterest.com/js/pinit.js';
				$('body').append(node3);
			}

			if (typeof WH.imageFeedback != 'undefined') {
				WH.imageFeedback();
			}
			if (typeof WH.uciFeedback != 'undefined') {
				WH.uciFeedback();
			}
		});
	})(jQuery);
</script>
<script>/*<![CDATA[*/window.jQuery && jQuery.ready();/*]]>*/</script><script>if(window.mw){
mw.loader.state({"site":"ready","user":"ready","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.action.view.postEdit","mediawiki.user","mediawiki.page.ready","mediawiki.searchSuggest","ext.Drafts"],null,true);
}</script>

		<!-- shown patrolled revid=13273805, latest=13273805 -->
<!-- Served by app6.wikihow.com in 2.506 secs on 2014-04-22 20:27:55 PDT. -->

<iframe src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/global-frame.html" name="petametrics-global-frame-238" id="petametrics-global-frame-238" style="width: 0px; height: 0px; display: none;"></iframe><iframe style="display: none; width: 0px; height: 0px;" name="google_osd_static_frame" id="google_osd_static_frame_3970625727729"></iframe><iframe tabindex="-1" style="width: 1px; height: 1px; position: absolute; top: -100px;" src="How%20to%20Create%20a%20Secure%20Login%20Script%20in%20PHP%20and%20MySQL%20-%20wikiHow_files/postmessageRelay.html" id="oauth2relay572784250" name="oauth2relay572784250"></iframe></body><iframe src="" style="display: none;"></iframe></html>